<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Initial Exploration • unhcrdatapackage</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Initial Exploration">
<meta property="og:description" content="unhcrdatapackage">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">unhcrdatapackage</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/BumpChart.html">Bump charts</a>
    </li>
    <li>
      <a href="../articles/Exploration.html">Initial Exploration</a>
    </li>
    <li>
      <a href="../articles/prediction.html">Initial Exploration</a>
    </li>
    <li>
      <a href="../articles/pyramid.html">Age Pyramid</a>
    </li>
    <li>
      <a href="../articles/refugee-bar-chart-race.html">Bar Chart Race for Refugees</a>
    </li>
    <li>
      <a href="../articles/refugee-population-viz.html">Refugee Population Data Visualisation</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Exploration_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Initial Exploration</h1>
            
            <h4 class="date">2020-09-21</h4>
      
      
      <div class="hidden name"><code>Exploration.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw">unhcr_style</span> <span class="op">&lt;-</span> <span class="fu">function</span>() {
  <span class="kw">font</span> <span class="op">&lt;-</span> <span class="st">"Lato"</span>
  <span class="kw">ggplot2</span>::<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(
    
<span class="co">#This sets the font, size, type and colour of text for the chart's title</span>
  plot.title = <span class="kw">ggplot2</span>::<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(family=<span class="kw">font</span>, size=<span class="fl">20</span>, face = <span class="st">"bold"</span>, color = <span class="st">"#222222"</span>),

<span class="co">#This sets the font, size, type and colour of text for the chart's subtitle,  as well as setting a margin between the title and the subtitle</span>
  plot.subtitle = <span class="kw">ggplot2</span>::<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(family=<span class="kw">font</span>, size=<span class="fl">16</span>, margin=<span class="kw">ggplot2</span>::<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span>(<span class="fl">9</span>,<span class="fl">0</span>,<span class="fl">9</span>,<span class="fl">0</span>)),
  plot.caption = <span class="kw">ggplot2</span>::<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),

<span class="co">#This sets the position and alignment of the legend, removes a title and backround for it and sets the requirements for any text within the legend. The legend may often need some more manual tweaking when it comes to its exact position based on the plot coordinates.</span>
  legend.position = <span class="st">"top"</span>,
  legend.text.align = <span class="fl">0</span>,
  legend.background = <span class="kw">ggplot2</span>::<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),
  legend.title = <span class="kw">ggplot2</span>::<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),
  legend.key = <span class="kw">ggplot2</span>::<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),
  legend.text = <span class="kw">ggplot2</span>::<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(family=<span class="kw">font</span>, size=<span class="fl">13</span>, color = <span class="st">"#222222"</span>),

<span class="co">#This sets the text font, size and colour for the axis test, as well as setting the margins and removes lines and ticks. In some cases, axis lines and axis ticks are things we would want to have in the chart</span>
  axis.title = <span class="kw">ggplot2</span>::<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),
  axis.text = <span class="kw">ggplot2</span>::<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(family=<span class="kw">font</span>, size=<span class="fl">13</span>, color = <span class="st">"#222222"</span>),
  axis.text.x = <span class="kw">ggplot2</span>::<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(margin=<span class="kw">ggplot2</span>::<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span>(<span class="fl">5</span>, b = <span class="fl">10</span>)),
  axis.ticks = <span class="kw">ggplot2</span>::<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),
  axis.line = <span class="kw">ggplot2</span>::<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),

<span class="co">#This removes all minor gridlines and adds major y gridlines. In many cases you will want to change this to remove y gridlines and add x gridlines. </span>
  panel.grid.minor = <span class="kw">ggplot2</span>::<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),
  panel.grid.major.y = <span class="kw">ggplot2</span>::<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span>(color = <span class="st">"#cbcbcb"</span>),
  panel.grid.major.x = <span class="kw">ggplot2</span>::<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),

<span class="co">#This sets the panel background as blank, removing the standard grey ggplot background colour from the plot</span>
  panel.background = <span class="kw">ggplot2</span>::<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),

<span class="co">#This sets the panel background for facet-wrapped plots to white, removing the standard grey ggplot background colour and sets the title size of the facet-wrap title to font size 22</span>
  strip.background = <span class="kw">ggplot2</span>::<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span>(fill = <span class="st">"white"</span>),
  strip.text = <span class="kw">ggplot2</span>::<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(size  = <span class="fl">13</span>,  hjust = <span class="fl">0</span>)
  )
}

<span class="co">#Left align text</span>
<span class="kw">left_align</span> <span class="op">&lt;-</span> <span class="fu">function</span>(<span class="kw">plot_name</span>, <span class="kw">pieces</span>){
  <span class="kw">grob</span> <span class="op">&lt;-</span> <span class="kw">ggplot2</span>::<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplotGrob.html">ggplotGrob</a></span>(<span class="kw">plot_name</span>)
  <span class="kw">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">pieces</span>)
  <span class="kw">grob</span><span class="op">$</span><span class="kw">layout</span><span class="op">$</span><span class="kw">l</span>[<span class="kw">grob</span><span class="op">$</span><span class="kw">layout</span><span class="op">$</span><span class="kw">name</span> <span class="op">%in%</span> <span class="kw">pieces</span>] <span class="op">&lt;-</span> <span class="fl">2</span>
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="kw">grob</span>)
}


<span class="co">## a little help function to better format numbers</span>
<span class="kw">format_si</span> <span class="op">&lt;-</span> <span class="fu">function</span>(<span class="kw">...</span>) {
  <span class="fu">function</span>(<span class="kw">x</span>) {
    <span class="kw">limits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1e-24</span>, <span class="fl">1e-21</span>, <span class="fl">1e-18</span>, <span class="fl">1e-15</span>, <span class="fl">1e-12</span>,
                <span class="fl">1e-9</span>,  <span class="fl">1e-6</span>,  <span class="fl">1e-3</span>,  <span class="fl">1e0</span>,   <span class="fl">1e3</span>,
                <span class="fl">1e6</span>,   <span class="fl">1e9</span>,   <span class="fl">1e12</span>,  <span class="fl">1e15</span>,  <span class="fl">1e18</span>,
                <span class="fl">1e21</span>,  <span class="fl">1e24</span>)
    <span class="kw">prefix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"y"</span>,   <span class="st">"z"</span>,   <span class="st">"a"</span>,   <span class="st">"f"</span>,   <span class="st">"p"</span>,
                <span class="st">"n"</span>,   <span class="st">""</span>,   <span class="st">"m"</span>,   <span class="st">" "</span>,   <span class="st">"k"</span>,
                <span class="st">"M"</span>,   <span class="st">"G"</span>,   <span class="st">"T"</span>,   <span class="st">"P"</span>,   <span class="st">"E"</span>,
                <span class="st">"Z"</span>,   <span class="st">"Y"</span>)

    <span class="co"># Vector with array indices according to position in intervals</span>
    <span class="kw">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/findInterval.html">findInterval</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(<span class="kw">x</span>), <span class="kw">limits</span>)

    <span class="co"># Set prefix to " " for very small values &lt; 1e-24</span>
    <span class="kw">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="kw">i</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="kw">limits</span> <span class="op">==</span> <span class="fl">1e0</span>), <span class="kw">i</span>)

    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="kw">x</span><span class="op">/</span><span class="kw">limits</span>[<span class="kw">i</span>], <span class="fl">1</span>),
                 trim = <span class="fl">TRUE</span>, scientific = <span class="fl">FALSE</span>, <span class="kw">...</span>),
          <span class="kw">prefix</span>[<span class="kw">i</span>])
  }
}
</pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="co"># Time series</span>

<span class="kw">time_series</span> <span class="op">&lt;-</span>  <span class="kw">unhcrdatapackage</span>::<span class="kw"><a href="../reference/end_year_population_totals.html">end_year_population_totals</a></span>

<span class="kw">reference</span> <span class="op">&lt;-</span> <span class="kw">unhcrdatapackage</span>::<span class="kw"><a href="../reference/reference.html">reference</a></span>

<span class="kw">time_series2</span> <span class="op">&lt;-</span> <span class="kw">reshape2</span>::<span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span>(<span class="kw">time_series</span>,
                                           <span class="co"># ID variables - all the variables to keep but not split apart on</span>
                                           id.vars=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Year"</span>, <span class="st">"CountryOriginCode"</span>,<span class="st">"CountryAsylumCode"</span>,<span class="st">"CountryOriginName"</span>,<span class="st">"CountryAsylumName"</span> ),
                                           <span class="co"># The source columns</span>
                                           measure.vars=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"REF"</span>,<span class="st">"IDP"</span>, <span class="st">"ASY"</span>,<span class="st">"OOC"</span>,<span class="st">"STA"</span>,<span class="st">"VDA"</span>),
                                           <span class="co"># Name of the destination column that will identify the original</span>
                                           <span class="co"># column that the measurement came from</span>
                                           variable.name=<span class="st">"Population.type"</span>,
                                           value.name=<span class="st">"Value"</span>) 

<span class="kw">time_series2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span>(x = <span class="kw">time_series2</span>, by.x=<span class="st">"CountryOriginCode"</span>, y = <span class="kw">reference</span>, by.y= <span class="st">"iso_3"</span>, all.x = <span class="fl">TRUE</span>)

<span class="co"># Population, GDP &amp; GNP per Capita from WorldBank</span>
<span class="kw">wb_data</span> <span class="op">&lt;-</span> <span class="fu">wb</span>( indicator = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"SP.POP.TOTL"</span>, <span class="st">"NY.GDP.MKTP.CD"</span>, <span class="st">"NY.GDP.PCAP.CD"</span>, <span class="st">"NY.GNP.PCAP.CD"</span>),
               startdate = <span class="fl">1951</span>, enddate = <span class="fl">2017</span>, return_wide = <span class="fl">TRUE</span>)
<span class="co"># Renaming variables for further matching</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">wb_data</span>)[<span class="fl">1</span>] <span class="op">&lt;-</span> <span class="st">"CountryAsylumCode"</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">wb_data</span>)[<span class="fl">2</span>] <span class="op">&lt;-</span> <span class="st">"Year"</span>

<span class="co">## Getting world map for mapping</span>
<span class="kw">world</span> <span class="op">&lt;-</span> <span class="fu">ne_countries</span>(scale = <span class="st">"small"</span>, returnclass = <span class="st">"sf"</span>)
<span class="kw">centroids</span> <span class="op">&lt;-</span> <span class="fu">st_transform</span>(<span class="kw">world</span><span class="op">$</span><span class="kw">geometry</span>, <span class="st">'+init=epsg:3857'</span>) <span class="op">%&gt;%</span>  
  <span class="co">## Reprojected in order to get centroid</span>
  <span class="fu">st_centroid</span>() <span class="op">%&gt;%</span> 
  <span class="co"># this is the crs from d, which has no EPSG code:</span>
  <span class="fu">st_transform</span>(<span class="kw">.</span>, <span class="st">'+init=epsg:4326'</span>) <span class="op">%&gt;%</span>
  <span class="co"># since we want the centroids in long lat:</span>
  <span class="fu">st_geometry</span>()
<span class="kw">world_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="kw">world</span>, <span class="fu">st_coordinates</span>(<span class="kw">centroids</span>))
</pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="co">#Prepare data</span>
<span class="kw">line_df</span> <span class="op">&lt;-</span> <span class="kw">time_series2</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">Population.type</span>  <span class="op">==</span> <span class="st">"REF"</span>) <span class="op">%&gt;%</span>
  <span class="fu">group_by</span>(<span class="kw">Year</span>) <span class="op">%&gt;%</span>
  <span class="fu">summarise</span>(Value2 = <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw">Value</span>) ) 


<span class="co">#Make plot</span>
<span class="kw">line</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span>(<span class="kw">line_df</span>, <span class="fu">aes</span>(x = <span class="kw">Year</span>, y = <span class="kw">Value2</span>)) <span class="op">+</span>
  <span class="fu">geom_line</span>(colour = <span class="st">"#0072bc"</span>, size = <span class="fl">1</span>) <span class="op">+</span> <span class="co"># Here we mention that it will be a line chart</span>
 <span class="co"># geom_hline(yintercept = 0, size = 1, colour = "#333333") +</span>
  <span class="fu">unhcr_style</span>() <span class="op">+</span> <span class="co">## Insert UNHCR Style</span>
  <span class="fu">scale_y_continuous</span>(label = <span class="fu">format_si</span>()) <span class="op">+</span> <span class="co">## Format axis number</span>
  <span class="co">## and the chart labels</span>
  <span class="fu">labs</span>(title = <span class="st">"More and More refugees"</span>,
       subtitle = <span class="st">"World wide refugee population 1951-2017"</span>, 
       caption = <span class="st">"UNHCR https://www.unhcr.org/refugee-statistics/"</span>)

<span class="co">#plot(line)</span>
<span class="kw">ggpubr</span>::<span class="fu"><a href="https://rdrr.io/pkg/ggpubr/man/ggarrange.html">ggarrange</a></span>(<span class="fu">left_align</span>(<span class="kw">line</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"subtitle"</span>, <span class="st">"title"</span>)), ncol = <span class="fl">1</span>, nrow = <span class="fl">1</span>)
</pre></div>
<p><img src="Exploration_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="co">#Prepare data</span>
<span class="kw">multiple_line_df</span> <span class="op">&lt;-</span> <span class="kw">time_series2</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">Population.type</span>  <span class="op">==</span> <span class="st">"REF"</span> <span class="op">&amp;</span> <span class="op">!</span>(<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="kw">REGION_UN</span>))) <span class="op">%&gt;%</span>
  <span class="fu">group_by</span>(<span class="kw">Year</span>, <span class="kw">REGION_UN</span> ) <span class="op">%&gt;%</span>
  <span class="fu">summarise</span>(Value2 = <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw">Value</span>) ) 

<span class="co">#Make plot</span>
<span class="kw">multiple_line</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span>(<span class="kw">multiple_line_df</span>, <span class="fu">aes</span>(x = <span class="kw">Year</span>, y = <span class="kw">Value2</span>, 
                                              colour = <span class="kw">REGION_UN</span>)) <span class="op">+</span> <span class="co"># Adding reference to color</span>
  <span class="fu">geom_line</span>(size = <span class="fl">1</span>) <span class="op">+</span> <span class="co"># Here we mention that it will be a line chart</span>
  <span class="fu">geom_hline</span>(yintercept = <span class="fl">0</span>, size = <span class="fl">1</span>, colour = <span class="st">"#333333"</span>) <span class="op">+</span>
  <span class="fu">scale_y_continuous</span>( label = <span class="fu">format_si</span>()) <span class="op">+</span> <span class="co">## Format axis number</span>
  <span class="fu">scale_colour_viridis_d</span>() <span class="op">+</span> <span class="co">## Add color for each lines based on color-blind friendly palette</span>
  <span class="fu">unhcr_style</span>() <span class="op">+</span> <span class="co">## Insert UNHCR Style</span>
  <span class="co">## and the chart labels</span>
  <span class="fu">labs</span>(title = <span class="st">"Refugees Population are not equally spread"</span>,
       subtitle = <span class="st">"World wide refugee population 1951-2017"</span>, 
       caption = <span class="st">"UNHCR https://www.unhcr.org/refugee-statistics/"</span>)

<span class="co">#plot(multiple_line)</span>
<span class="kw">ggpubr</span>::<span class="fu"><a href="https://rdrr.io/pkg/ggpubr/man/ggarrange.html">ggarrange</a></span>(<span class="fu">left_align</span>(<span class="kw">multiple_line</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"subtitle"</span>, <span class="st">"title"</span>)), ncol = <span class="fl">1</span>, nrow = <span class="fl">1</span>)
</pre></div>
<p><img src="Exploration_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div id="bar-chart" class="section level2">
<h2 class="hasAnchor">
<a href="#bar-chart" class="anchor"></a>Bar chart</h2>
<p>Some key points to consider when designing bar chart are:</p>
<ul>
<li><p>Start at the zero baseline! No exception. Do not clip the axis in order to highlight disparities at the top of the axis. Instead, try recalculating your data as percentages, or try another type of chart;</p></li>
<li><p>Ensure numerical axis labels are aligned to the decimal point;</p></li>
<li><p>Clearly denote currency or units;</p></li>
<li><p>When axis lines are present, it is not necessary to label each data value. However, it can be useful to highlight the final value or other important data points.</p></li>
<li><p>Convert your data to rounded, easily digestible values for chart labeling</p></li>
<li><p>Omit axes and baselines when data values are labeled, simpler, better!</p></li>
<li><p>When the range of your data crosses natural numerical milestones, such as from millions to billions, set the entire chart in the larger milestone. A chart should never reflect more than 1,000 millions. etc.</p></li>
<li><p>Ensure labels fit neatly under the bars in no more than two lines.</p></li>
<li><p>Horizontal bar charts help compare long lists of values or categories. It has the advantage of printing long labels without using two lines or printing vertical text, as would be required for a vertical bar.</p></li>
<li><p>Remember to sort your data before charting so that readers can easily compare.</p></li>
<li><p>Labeled values eliminate the need for grid lines, while rounding is done to make the values easy to digest.</p></li>
<li><p>Don’t use 3D effect!</p></li>
</ul>
<p>Note that by default, R will display your data in alphabetical order, but arranging it by size instead is simple: just wrap <code><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder()</a></code> around the <code>x</code> or <code>y</code> variable you want to rearrange, and specify which variable you want to reorder it by.</p>
<p>E.g. <code>x = reorder(Country, Value2)</code>. Ascending order is the default, but you can change it to descending by wrapping <code>desc()</code> around the variable you’re ordering by.</p>
<p><strong>Let’s see what code is required for such chart: </strong></p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="co">#Prepare data2</span>
<span class="kw">bar_df</span> <span class="op">&lt;-</span> <span class="kw">time_series2</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">Population.type</span>  <span class="op">==</span> <span class="st">"REF"</span> <span class="op">&amp;</span> <span class="kw">Year</span> <span class="op">==</span> <span class="fl">2016</span>) <span class="op">%&gt;%</span>
  <span class="fu">group_by</span>( <span class="kw">CountryAsylumName</span>, <span class="kw">SUBREGION</span>) <span class="op">%&gt;%</span>
  <span class="fu">summarise</span>(Value2 = <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw">Value</span>) )  <span class="op">%&gt;%</span>
  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="kw">Value2</span>)) <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="fl">10</span>)

<span class="co">#Make plot</span>
<span class="kw">bars</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span>(<span class="kw">bar_df</span>, <span class="fu">aes</span>(x = <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span>(<span class="kw">CountryAsylumName</span>, <span class="kw">Value2</span>), <span class="co">## Reordering country by Value</span>
                           y = <span class="kw">Value2</span>)) <span class="op">+</span>
  <span class="fu">geom_bar</span>(stat = <span class="st">"identity"</span>, 
           position = <span class="st">"identity"</span>, 
           fill = <span class="st">"#0072bc"</span>) <span class="op">+</span> <span class="co"># here we configure that it will be bar chart</span>
  <span class="fu">geom_hline</span>(yintercept = <span class="fl">0</span>, size = <span class="fl">1</span>, colour = <span class="st">"#333333"</span>) <span class="op">+</span>
  <span class="fu">coord_flip</span>() <span class="op">+</span> <span class="co"># Add `coord_flip()` to make your vertical bars horizontal:</span>
  <span class="fu">unhcr_style</span>() <span class="op">+</span> <span class="co">## Insert UNHCR Style</span>
  <span class="co">## and the chart labels</span>
  <span class="fu">labs</span>(title = <span class="st">"Turkey is by the far the biggest Refugee hosting country"</span>,
       subtitle = <span class="st">"Top 10 Refugee Population per country in 2017"</span>, 
       caption = <span class="st">"UNHCR https://www.unhcr.org/refugee-statistics/"</span>) <span class="op">+</span>
  <span class="fu">scale_y_continuous</span>( label = <span class="fu">format_si</span>()) <span class="op">+</span> <span class="co">## Format axis number</span>
  <span class="fu">theme</span>(panel.grid.major.x = <span class="fu">element_line</span>(color = <span class="st">"#cbcbcb"</span>), 
        panel.grid.major.y = <span class="fu">element_blank</span>()) <span class="co">### changing grid line that should appear</span>

<span class="co">#plot(bars)</span>
<span class="kw">ggpubr</span>::<span class="fu"><a href="https://rdrr.io/pkg/ggpubr/man/ggarrange.html">ggarrange</a></span>(<span class="fu">left_align</span>(<span class="kw">bars</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"subtitle"</span>, <span class="st">"title"</span>)), ncol = <span class="fl">1</span>, nrow = <span class="fl">1</span>)
</pre></div>
<p><img src="Exploration_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div id="stacked-bar-chart" class="section level2">
<h2 class="hasAnchor">
<a href="#stacked-bar-chart" class="anchor"></a>Stacked bar chart</h2>
<p><strong>Let’s see what code is required for such chart: </strong></p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="co">#prepare data</span>
<span class="kw">df1</span> <span class="op">&lt;-</span> <span class="kw">time_series2</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">Population.type</span>  <span class="op">==</span> <span class="st">"REF"</span> <span class="op">&amp;</span> <span class="kw">Year</span> <span class="op">==</span> <span class="fl">2016</span> <span class="op">&amp;</span> <span class="op">!</span>(<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="kw">REGION_UN</span>))) <span class="op">%&gt;%</span>
  <span class="fu">group_by</span>(<span class="kw">Year</span>, <span class="kw">CountryAsylumName</span>, <span class="kw">CountryAsylumCode</span>, <span class="kw">REGION_UN</span> ) <span class="op">%&gt;%</span>
  <span class="fu">summarise</span>(Value2 = <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw">Value</span>) )

<span class="kw">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span>(x = <span class="kw">df1</span>, y = <span class="kw">wb_data</span>, by = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"CountryAsylumCode"</span> ,<span class="st">"Year"</span>), all.x = <span class="fl">TRUE</span>)
<span class="kw">df2</span> <span class="op">&lt;-</span> <span class="kw">df2</span>[ <span class="op">!</span>(<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="kw">df2</span><span class="op">$</span><span class="kw">REGION_UN</span>)) <span class="op">&amp;</span> <span class="op">!</span>(<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="kw">df2</span><span class="op">$</span><span class="kw">NY.GNP.PCAP.CD</span>)) , ]
<span class="kw">df2</span><span class="op">$</span><span class="kw">prop</span> <span class="op">&lt;-</span> <span class="kw">df2</span><span class="op">$</span><span class="kw">Value2</span> <span class="op">/</span> <span class="kw">df2</span><span class="op">$</span><span class="kw">SP.POP.TOTL</span>

<span class="kw">stacked_df1</span> <span class="op">&lt;-</span> <span class="kw">df2</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span>(CountryClass = <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span>(<span class="kw">NY.GNP.PCAP.CD</span>, 
                              breaks = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">1005</span>, <span class="fl">3955</span>, <span class="fl">12235</span>, <span class="fl">150000</span>),
                              labels = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Low-income"</span>, <span class="st">"Lower-middle income"</span>, <span class="st">"Upper-middle income"</span>, <span class="st">"High-income"</span>))) <span class="op">%&gt;%</span>
  <span class="fu">group_by</span>(<span class="kw">REGION_UN</span>, <span class="kw">CountryClass</span>) <span class="op">%&gt;%</span>
  <span class="fu">summarise</span>(Value3 = <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw">Value2</span>)))

<span class="co">#create plot</span>
<span class="kw">stacked_bars</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span>(data = <span class="kw">stacked_df1</span>, 
                     <span class="fu">aes</span>(x = <span class="kw">REGION_UN</span>,
                         y = <span class="kw">Value3</span>,
                         fill = <span class="kw">CountryClass</span>)) <span class="op">+</span>
                <span class="fu">geom_bar</span>(stat = <span class="st">"identity"</span>, 
                         position = <span class="st">"fill"</span>) <span class="op">+</span>
                <span class="fu">unhcr_style</span>() <span class="op">+</span>
                <span class="fu">scale_y_continuous</span>(labels = <span class="kw">scales</span>::<span class="kw"><a href="https://scales.r-lib.org//reference/label_percent.html">percent</a></span>) <span class="op">+</span>
                <span class="fu">scale_fill_viridis_d</span>(direction = <span class="op">-</span><span class="fl">1</span>) <span class="op">+</span>
                <span class="fu">geom_hline</span>(yintercept = <span class="fl">0</span>, size = <span class="fl">1</span>, colour = <span class="st">"#333333"</span>) <span class="op">+</span>
                <span class="fu">labs</span>(title = <span class="st">"High Share of Refugees in Africa are hosted in low-income countries"</span>,
                     subtitle = <span class="st">"% of population by Country classification per Region, 2017"</span>, 
                     caption = <span class="st">"UNHCR https://www.unhcr.org/refugee-statistics/ - World Bank"</span>) <span class="op">+</span>
                <span class="fu">theme</span>(legend.position = <span class="st">"top"</span>, 
                      legend.justification = <span class="st">"left"</span>) <span class="op">+</span>
                <span class="fu">guides</span>(fill = <span class="fu">guide_legend</span>(reverse = <span class="fl">TRUE</span>))

<span class="kw">ggpubr</span>::<span class="fu"><a href="https://rdrr.io/pkg/ggpubr/man/ggarrange.html">ggarrange</a></span>(<span class="fu">left_align</span>(<span class="kw">stacked_bars</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"subtitle"</span>, <span class="st">"title"</span>)), ncol = <span class="fl">1</span>, nrow = <span class="fl">1</span>)
</pre></div>
<p><img src="Exploration_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>This example shows proportions, but you might want to make a stacked bar chart showing number values instead - this is easy to change!</p>
<p>The value passed to the <code>position</code> argument will determine if your stacked chart shows proportions or actual values.</p>
<p><code>position = "fill"</code> will draw your stacks as proportions, and <code>position = "identity"</code> will draw number values.</p>
</div>
<div id="grouped-bar-chart" class="section level2">
<h2 class="hasAnchor">
<a href="#grouped-bar-chart" class="anchor"></a>Grouped bar chart</h2>
<p>Making a grouped bar chart is very similar to making a bar chart.</p>
<p>You just need to change <code>position = "identity"</code> to <code>position = "dodge"</code>, and set the <code>fill</code> aesthetically instead:</p>
<p><strong>Let’s see what code is required for such chart: </strong></p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="co">#Prepare data</span>
<span class="kw">grouped_bar_df</span> <span class="op">&lt;-</span> <span class="kw">time_series2</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">Population.type</span>  <span class="op">==</span> <span class="st">"REF"</span>)  <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">Year</span> <span class="op">==</span> <span class="fl">2006</span> <span class="op">|</span> <span class="kw">Year</span> <span class="op">==</span> <span class="fl">2016</span>) <span class="op">%&gt;%</span>
    <span class="fu">group_by</span>( <span class="kw">CountryAsylumName</span>, <span class="kw">Year</span>) <span class="op">%&gt;%</span>
    <span class="fu">summarise</span>(Value2 = <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw">Value</span>) )  <span class="op">%&gt;%</span>
    <span class="fu">select</span>(<span class="kw">CountryAsylumName</span>, <span class="kw">Year</span>, <span class="kw">Value2</span>) <span class="op">%&gt;%</span>
    <span class="fu">spread</span>(<span class="kw">Year</span>, <span class="kw">Value2</span>) <span class="op">%&gt;%</span>
    <span class="fu">mutate</span>(gap = <span class="kw">`2016`</span> <span class="op">-</span> <span class="kw">`2006`</span>) <span class="op">%&gt;%</span>
    <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="kw">gap</span>)) <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="fl">10</span>) <span class="op">%&gt;%</span>
    <span class="fu">gather</span>(key = <span class="kw">Year</span>, 
           value = <span class="kw">Value2</span>,
           <span class="op">-</span><span class="kw">CountryAsylumName</span>,
           <span class="op">-</span><span class="kw">gap</span>) 
  
<span class="co">#Make plot</span>
<span class="kw">grouped_bars</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span>(<span class="kw">grouped_bar_df</span>, 
                       <span class="fu">aes</span>(x = <span class="kw">CountryAsylumName</span>, 
                           y = <span class="kw">Value2</span>, 
                           fill = <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="kw">Year</span>))) <span class="op">+</span>
  
  <span class="fu">coord_flip</span>() <span class="op">+</span>
  <span class="fu">geom_bar</span>(stat = <span class="st">"identity"</span>, position = <span class="st">"dodge"</span>) <span class="op">+</span>
  <span class="fu">geom_hline</span>(yintercept = <span class="fl">0</span>, size = <span class="fl">1</span>, colour = <span class="st">"#333333"</span>) <span class="op">+</span>
  <span class="fu">unhcr_style</span>() <span class="op">+</span>
  <span class="fu">scale_fill_manual</span>(values = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"#0072bc"</span>, <span class="st">"#FAAB18"</span>)) <span class="op">+</span>
  <span class="fu">labs</span>(title = <span class="st">"Biggest Increase Population"</span>,
       subtitle = <span class="st">"10 Biggest change in Refugee Population, 2006-2016"</span>, 
       caption = <span class="st">"UNHCR https://www.unhcr.org/refugee-statistics/"</span>) <span class="op">+</span>
  <span class="fu">scale_y_continuous</span>( label = <span class="fu">format_si</span>()) <span class="op">+</span> <span class="co">## Format axis number</span>
  <span class="fu">theme</span>(panel.grid.major.x = <span class="fu">element_line</span>(color = <span class="st">"#cbcbcb"</span>), 
        panel.grid.major.y = <span class="fu">element_blank</span>()) <span class="co">### changing grid line that should appear</span>


<span class="co">#plot(grouped_bars)</span>
<span class="kw">ggpubr</span>::<span class="fu"><a href="https://rdrr.io/pkg/ggpubr/man/ggarrange.html">ggarrange</a></span>(<span class="fu">left_align</span>(<span class="kw">grouped_bars</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"subtitle"</span>, <span class="st">"title"</span>)), ncol = <span class="fl">1</span>, nrow = <span class="fl">1</span>)
</pre></div>
<p><img src="Exploration_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div id="dumbbell-chart" class="section level2">
<h2 class="hasAnchor">
<a href="#dumbbell-chart" class="anchor"></a>Dumbbell chart</h2>
<p>Dumbbell plot (also known as Dumbbell chart, Connected dot plot) is great for displaying changes between two points in time, two conditions or differences between two groups. Another way of showing difference is a dumbbell chart:</p>
<p><strong>Let’s see what code is required for such chart: </strong></p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st"><a href="https://github.com/hrbrmstr/ggalt">"ggalt"</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st"><a href="https://tidyr.tidyverse.org">"tidyr"</a></span>)

<span class="co">#Prepare data</span>
<span class="kw">dumbbell_df</span> <span class="op">&lt;-</span> <span class="kw">time_series2</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">Population.type</span>  <span class="op">==</span> <span class="st">"REF"</span>)  <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">Year</span> <span class="op">==</span> <span class="fl">2006</span> <span class="op">|</span> <span class="kw">Year</span> <span class="op">==</span> <span class="fl">2016</span>) <span class="op">%&gt;%</span>
    <span class="fu">group_by</span>( <span class="kw">CountryAsylumCode</span>, <span class="kw">Year</span>) <span class="op">%&gt;%</span>
    <span class="fu">summarise</span>(Value2 = <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw">Value</span>) )  <span class="op">%&gt;%</span>
    <span class="fu">select</span>(<span class="kw">CountryAsylumCode</span>, <span class="kw">Year</span>, <span class="kw">Value2</span>) <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/spread.html">spread</a></span>(<span class="kw">Year</span>, <span class="kw">Value2</span>) <span class="op">%&gt;%</span>
    <span class="fu">mutate</span>(gap = <span class="kw">`2006`</span> <span class="op">-</span> <span class="kw">`2016`</span>) <span class="op">%&gt;%</span>
    <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="kw">gap</span>)) <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="fl">10</span>) 

<span class="co"># Make plot</span>
<span class="kw">dumbell</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span>(<span class="kw">dumbbell_df</span>, <span class="fu">aes</span>(x = <span class="kw">`2006`</span>, xend = <span class="kw">`2016`</span>,
                                   y = <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span>(<span class="kw">CountryAsylumCode</span>, <span class="kw">gap</span>),
                                   group = <span class="kw">CountryAsylumCode</span>)) <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggalt/man/geom_dumbbell.html">geom_dumbbell</a></span>(colour = <span class="st">"#dddddd"</span>,
                size = <span class="fl">3</span>,
                colour_x = <span class="st">"#0072bc"</span>,
                colour_xend = <span class="st">"#FAAB18"</span>) <span class="op">+</span>
  <span class="fu">unhcr_style</span>() <span class="op">+</span> 
  <span class="fu">labs</span>(title = <span class="st">"Where did Refugee Population decreased in the past 10 years?"</span>,
       subtitle = <span class="st">"Biggest decrease in Refugee Population, 2006-2016"</span>, 
       caption = <span class="st">"UNHCR https://www.unhcr.org/refugee-statistics/"</span>) <span class="op">+</span>
  <span class="fu">scale_x_continuous</span>( label = <span class="fu">format_si</span>()) <span class="op">+</span> <span class="co">## Format axis number</span>
  <span class="fu">theme</span>(panel.grid.major.x = <span class="fu">element_line</span>(color = <span class="st">"#cbcbcb"</span>), 
        panel.grid.major.y = <span class="fu">element_blank</span>()) <span class="co">### changing grid line that should appear</span>


<span class="co">#plot(grouped_bars)</span>
<span class="kw">ggpubr</span>::<span class="fu"><a href="https://rdrr.io/pkg/ggpubr/man/ggarrange.html">ggarrange</a></span>(<span class="fu">left_align</span>(<span class="kw">dumbell</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"subtitle"</span>, <span class="st">"title"</span>)), ncol = <span class="fl">1</span>, nrow = <span class="fl">1</span>)
</pre></div>
<p><img src="Exploration_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div id="histogram" class="section level2">
<h2 class="hasAnchor">
<a href="#histogram" class="anchor"></a>Histogram</h2>
<p>Histogram are used to plot the frequency of score occurrences in a continuous variable (numeric, integer) that has been divided into classes, called bins.</p>
<p>A histogram is <strong>not</strong> a bar chart: histograms are used to show distributions (or the shape) of variables while bar charts are used to compare variables.</p>
<p>Some data sets have a distinct shape. Data hardly ever fall into perfect patterns, so you have to decide whether the data shape. The two interpretation key are the following:</p>
<ul>
<li><p>Symmetric bell shape: if you cut it down the middle and the left-hand and right-hand sides resemble mirror images of each other. The middle of the chart is the place when the largest occurrence appears: in this case, we have something closed to a normal distribution. <strong>Kurtosis</strong> is a measure of whether the data are heavy-tailed or light-tailed relative to a normal distribution. That is, data sets with high kurtosis tend to have heavy tails, or outliers. Data sets with low kurtosis tend to have light tails, or lack of outliers.</p></li>
<li><p>Skewed right or left:looks like a lopsided mound, with a tail going off to the right or left. <strong>Skewness</strong> is a measure of symmetry, or more precisely, the lack of symmetry. A distribution, or data set, is symmetric if it looks the same to the left and right of the center point.</p></li>
</ul>
<p>A uniform distribution would be the extreme case.</p>
<p><strong>Let’s see what code is required for such chart: </strong></p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="co"># Prepare Data</span>
 <span class="kw">hist_df</span> <span class="op">&lt;-</span>  <span class="kw">df2</span> <span class="op">%&gt;%</span>
    <span class="fu">mutate</span>(ref.per.local = (<span class="kw">Value2</span> <span class="op">/</span> <span class="kw">SP.POP.TOTL</span>) <span class="op">*</span> <span class="fl">100</span>) <span class="op">%&gt;%</span>
    <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="kw">Value2</span>)) <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="fl">50</span>)
  
<span class="co"># Chart</span>
<span class="kw">histo</span> <span class="op">&lt;-</span>  <span class="fu">ggplot</span>(<span class="kw">hist_df</span>, <span class="fu">aes</span>(<span class="kw">ref.per.local</span>)) <span class="op">+</span>
    <span class="fu">geom_histogram</span>( colour = <span class="st">"white"</span>, fill = <span class="st">"#0072bc"</span>) <span class="op">+</span>
    <span class="fu">geom_hline</span>(yintercept = <span class="fl">0</span>, size = <span class="fl">1</span>, colour = <span class="st">"#333333"</span>) <span class="op">+</span>
    <span class="fu">unhcr_style</span>() <span class="op">+</span>
    <span class="fu">scale_x_continuous</span>(limits = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">20</span>)) <span class="op">+</span>
    <span class="fu">labs</span>(ylab = <span class="st">"Count of countries"</span>,
         title = <span class="st">"Only 2 countries have more than 5 refugees per 100 locals"</span>,
         subtitle = <span class="st">"Distribution of refugee to local ratio for top 50 refugee hosting countries  in 2016"</span>, 
         caption = <span class="st">"UNHCR https://www.unhcr.org/refugee-statistics/ - World Bank"</span>)


<span class="kw">ggpubr</span>::<span class="fu"><a href="https://rdrr.io/pkg/ggpubr/man/ggarrange.html">ggarrange</a></span>(<span class="fu">left_align</span>(<span class="kw">histo</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"subtitle"</span>, <span class="st">"title"</span>)), ncol = <span class="fl">1</span>, nrow = <span class="fl">1</span>)
</pre></div>
<p><img src="Exploration_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div id="scatterplot" class="section level2">
<h2 class="hasAnchor">
<a href="#scatterplot" class="anchor"></a>Scatterplot</h2>
<p>Scatter plot are used to check for correlation. A trend line can be added to compare two set of measures to determine if as one set goes up, the other set correspondingly goes up or down and how strongly.</p>
<p>Scatter plot are also a good way to identify clusters of observation.</p>
<p><strong>Let’s see what code is required for such chart: </strong></p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="co">## Chart</span>
<span class="kw">scatter</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span>(<span class="kw">df2</span>, <span class="fu">aes</span>(y = <span class="kw">Value2</span>, x = <span class="kw">NY.GDP.MKTP.CD</span>)) <span class="op">+</span> 
  <span class="fu">geom_point</span>(<span class="fu">aes</span>(col = <span class="kw">REGION_UN</span>)) <span class="op">+</span> 
  <span class="co">#geom_smooth(method = "loess", se = F) + </span>
  <span class="fu">unhcr_style</span>() <span class="op">+</span>
  <span class="fu">scale_x_continuous</span>( label = <span class="fu">format_si</span>(), ) <span class="op">+</span> <span class="co">## Format axis number</span>
  <span class="fu">scale_y_continuous</span>( label = <span class="fu">format_si</span>(), 
                      limits = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">1000000</span>)) <span class="op">+</span> <span class="co">## Format axis number</span>
  <span class="fu">scale_color_viridis_d</span>(direction = <span class="op">-</span><span class="fl">1</span>) <span class="op">+</span>
  <span class="fu">labs</span>(title = <span class="st">"Refugee hosting is not correlated with Economic Wealth"</span>, 
       subtitle = <span class="st">"Refugee population Vs GDP"</span>, 
       y = <span class="st">"Refugee"</span>, 
       x = <span class="st">"Gross domestic product (GDP)"</span>, 
       caption = <span class="st">"2016 Figures, UNHCR https://www.unhcr.org/refugee-statistics/, World bank"</span>) <span class="op">+</span>
  <span class="fu">theme</span>(axis.title = <span class="fu">element_text</span>(size = <span class="fl">12</span>))


<span class="kw">ggpubr</span>::<span class="fu"><a href="https://rdrr.io/pkg/ggpubr/man/ggarrange.html">ggarrange</a></span>(<span class="fu">left_align</span>(<span class="kw">scatter</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"subtitle"</span>, <span class="st">"title"</span>)), ncol = <span class="fl">1</span>, nrow = <span class="fl">1</span>)
</pre></div>
<p><img src="Exploration_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
<div id="maps" class="section level2">
<h2 class="hasAnchor">
<a href="#maps" class="anchor"></a>Maps</h2>
<p>A map is a graphic representation or scale model of spatial concepts. It is a means for conveying geographic information. Maps are a universal medium for communication, easily understood and appreciated by most people, regardless of language or culture. Maps are not realistic representations of the actual world. All maps are estimations, generalizations, and interpretations of true geographic conditions.</p>
<p>One key rule when creating a map is:</p>
<ol style="list-style-type: decimal">
<li>Absolute value: Proportional symbol</li>
<li>Relative value (ratio): Choropleth</li>
</ol>
<p><strong>Let’s see what code is required for such chart: </strong></p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="co"># Merge data with geographic coordinates</span>
<span class="kw">world</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span>(x = <span class="kw">world</span> , y = <span class="kw">df2</span>, by.y = <span class="st">"CountryAsylumCode"</span> , by.x = <span class="st">"iso_a3"</span>)
<span class="kw">df3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span>(x = <span class="kw">df2</span> , y = <span class="kw">world_points</span>, by.x = <span class="st">"CountryAsylumCode"</span> , by.y = <span class="st">"iso_a3"</span>)


<span class="co"># plot</span>
<span class="kw">map</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span>(data = <span class="kw">world</span>) <span class="op">+</span> 
  <span class="fu">geom_sf</span>(fill = <span class="st">"antiquewhite"</span>, colour = <span class="st">"#7f7f7f"</span>, size = <span class="fl">0.2</span>) <span class="op">+</span> 
  <span class="fu">coord_sf</span>(xlim = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="fl">25</span>, <span class="fl">65</span>), ylim = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">25</span>, <span class="fl">75</span>), expand = <span class="fl">FALSE</span>) <span class="op">+</span> <span class="co">## Clipping on Mediterranean Sea</span>
  <span class="fu">geom_point</span>(data = <span class="kw">df3</span>, <span class="fu">aes</span>(x = <span class="kw">X</span>, y = <span class="kw">Y</span> , size = <span class="kw">Value2</span> ), 
             alpha = <span class="fl">0.6</span>, colour = <span class="st">"red"</span>) <span class="op">+</span>
  <span class="fu">scale_size_area</span>( max_size = <span class="fl">20</span>) <span class="op">+</span>
  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="op">+</span>
  <span class="fu">ylab</span>(<span class="st">""</span>) <span class="op">+</span> 
  <span class="fu">ggtitle</span>(<span class="st">"Refugee Distribution"</span>) <span class="op">+</span> 
  <span class="fu">unhcr_style</span>() <span class="op">+</span>
  <span class="fu">theme</span>(panel.grid.major = <span class="fu">element_line</span>(color = <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html">gray</a></span>(<span class="fl">.5</span>), 
                                        linetype = <span class="st">"dashed"</span>, size = <span class="fl">0.5</span>),
        panel.background = <span class="fu">element_rect</span>(fill = <span class="st">"aliceblue"</span>),
        axis.text.x  = <span class="fu">element_blank</span>(),
        axis.text.y  = <span class="fu">element_blank</span>(),
        legend.position = <span class="st">"none"</span>
        )


<span class="kw">ggpubr</span>::<span class="fu"><a href="https://rdrr.io/pkg/ggpubr/man/ggarrange.html">ggarrange</a></span>(<span class="fu">left_align</span>(<span class="kw">map</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"title"</span>)), ncol = <span class="fl">1</span>, nrow = <span class="fl">1</span>)
</pre></div>
<p><img src="Exploration_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Edouard Legoupil.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
