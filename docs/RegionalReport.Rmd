---
title: "AMERICAS REGIONAL POPULATION TRENDS ANALYSIS"
subtitle: "Forced Displacement in 2020"
abstract-title: UNHCR Regional Bureau for the Americas
abstract: "This report provides a summary overview of population statistics of the Americas region in 2020 based on __officially published and publicly available data__. It includes trends and analysis of the major population groups and major displacement situations in the region."
date: "September 2021"
params:
  bureau: Americas
  year: 2020
author:
  - name: Laura Giammarinaro
    affiliation: Senior DIMA Coordinator
    email: <Giammari@unhcr.org>
  - name: Statistics & Data Analysis Team
    affiliation: DIMA
    email: <contact2email@unhcr.org>
output: 
  unhcRstyle::unhcr_templ_paged: 
    # Change to point to your cover file
    # Try to keep as is it includes back cover UNHCR blue background and logo
    # Change to false to remove table of content
    # Change to true to add number in front of chapters
    # Change to true for a self-contained document, but it'll be a litte slower for Pandoc to render
    front_cover: media/image_protect2.png
    back_cover: img/unhcr_backcover.svg
    # Change to false to remove table of content
    toc: true
    toc_depth: 2
    # Change to true to add number in front of chapters
    number_sections: false
    # Change to true for a self-contained document, but it'll be a litte slower for Pandoc to render
    self_contained: true
# Set  toc title, default none
toc-title: Contents
# Change to false to remove list of tables
lot: false
# Set lot title, default: "List of Tables"
lot-title: "Tables"
# Change to false to remove list of figures
lof: false
# Set lof title, default: "List of Figures"
lof-title: "List of Figures"
# If you include any <abbr> a list of abbreviations will be built.
# Set lof title, default: "List of Abbreviations"
loa-title: "Acronyms"
# Include footnotes direclty in the related page
paged-footnotes: true
# Turn links to footnote when printing the PDF on/off
links-to-footnotes: true
# uncomment this line to produce HTML and PDF in RStudio:
#knit: pagedown::chrome_print
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```


```{r setuppack, include=FALSE, message=FALSE, warning=FALSE}
using <- function(...) {
    libs <- unlist(list(...))
    req <- unlist(lapply(libs,require,character.only = TRUE))
    need <- libs[req == FALSE]
    if (length(need) > 0) { 
        install.packages(need)
        lapply(need,require,character.only = TRUE)
    }
}

using('tidyverse', 'ggplot2', 'scales',  'wbstats', 'ragg', 'magick', 'acled.api', 'circlize',
      'viridis', 'treemap',
      'treemapify', 'patchwork', 'networkD3', 'webshot')

library(tidyverse)
library(ggplot2)
library(scales)
library(ragg)
library(magick)
library(circlize)
library(wbstats)
library(acled.api)

# Load required packages for charts with UNHCR style 
library(unhcRstyle)
library(unhcrdatapackage)
update_geom_font_defaults()


```

```{r  include=FALSE, message=FALSE, warning=FALSE}
## Loading the stat tables
end_year_population_totals <- unhcrdatapackage::end_year_population_totals
reference <- unhcrdatapackage::reference
end_year_population_totals_long <- unhcrdatapackage::end_year_population_totals_long
end_year_population_totals_long.asy <- dplyr::left_join( x= unhcrdatapackage::end_year_population_totals_long, 
                                                     y= unhcrdatapackage::reference, 
                                                     by = c("CountryAsylumCode" = "iso_3"))

end_year_population_totals_long.ori <- dplyr::left_join( x= unhcrdatapackage::end_year_population_totals_long, 
                                                     y= unhcrdatapackage::reference, 
                                                     by = c("CountryOriginCode" = "iso_3"))

demographics <- unhcrdatapackage::demographics
asylum_applications <- unhcrdatapackage::asylum_applications
asylum_decisions <- unhcrdatapackage::asylum_decisions
asylum_decisions_long <- unhcrdatapackage::asylum_decisions_long

solutions <- unhcrdatapackage::solutions
solutions_long <- unhcrdatapackage::solutions_long
solutions_long.asy <- dplyr::left_join( x=  solutions_long, 
                                                     y= unhcrdatapackage::reference, 
                                                     by = c("CountryAsylumCode" = "iso_3"))
```


```{r  include=FALSE, message=FALSE, warning=FALSE}
## Key Figures calculation

## Retrieve report parameter as defined in the report YAML
#thisbureau <- "Americas"
thisbureau <- params$bureau
#lastyear <- max(end_year_population_totals_long.asy$Year)
lastyear <- params$year

allpop <- format(round(sum(end_year_population_totals_long.asy[end_year_population_totals_long.asy$UNHCRBureau == thisbureau &      end_year_population_totals_long.asy$Year ==lastyear  , 
                                     c("Value")])
             , -3),  big.mark=",")

allpop.prop <- format(round( sum(end_year_population_totals_long.asy[end_year_population_totals_long.asy$UNHCRBureau == thisbureau & 
                                                                       end_year_population_totals_long.asy$Year ==lastyear  , 
                                     c("Value")]) /
                               sum(end_year_population_totals_long.asy[end_year_population_totals_long.asy$Year ==lastyear  , 
                                     c("Value")]) 
             , 1)* 100,  big.mark=",")


allpop.prop.ref <- format(round( sum(end_year_population_totals_long.asy[end_year_population_totals_long.asy$UNHCRBureau == thisbureau & 
                                                                           end_year_population_totals_long.asy$Year ==lastyear &
                                       end_year_population_totals_long.asy$Population.type %in% c("REF") , 
                                     c("Value")]) /
                               sum(end_year_population_totals_long.asy[end_year_population_totals_long.asy$Year ==lastyear &
                                       end_year_population_totals_long.asy$Population.type %in% c("REF") , 
                                     c("Value")]) 
             , 3)* 100,  big.mark=",")

allpop.prop.asy <- format(round( sum(end_year_population_totals_long.asy[end_year_population_totals_long.asy$UNHCRBureau == thisbureau & 
                                                                           end_year_population_totals_long.asy$Year ==lastyear &
                                       end_year_population_totals_long.asy$Population.type %in% c("ASY") , 
                                     c("Value")]) /
                               sum(end_year_population_totals_long.asy[end_year_population_totals_long.asy$Year ==lastyear &
                                       end_year_population_totals_long.asy$Population.type %in% c("ASY") , 
                                     c("Value")]) 
             , 3)* 100,  big.mark=",")

allpop.prop.idp <- format(round( sum(end_year_population_totals_long.asy[end_year_population_totals_long.asy$UNHCRBureau == thisbureau &
                                                                           end_year_population_totals_long.asy$Year ==lastyear &
                                       end_year_population_totals_long.asy$Population.type %in% c("IDP") , 
                                     c("Value")]) /
                               sum(end_year_population_totals_long.asy[end_year_population_totals_long.asy$Year ==lastyear &
                                       end_year_population_totals_long.asy$Population.type %in% c("IDP") , 
                                     c("Value")]) 
             , 3)* 100,  big.mark=",")


totaldis <- format(round(sum(end_year_population_totals_long.asy[end_year_population_totals_long.asy$UNHCRBureau == thisbureau &      end_year_population_totals_long.asy$Year ==lastyear &
                                       end_year_population_totals_long.asy$Population.type %in% c("REF","ASY","VDA") , 
                                     c("Value")])
             , -3),  big.mark=",")

totalref <- format(round(sum(end_year_population_totals_long.asy[end_year_population_totals_long.asy$UNHCRBureau == thisbureau &      end_year_population_totals_long.asy$Year ==lastyear &
                                       end_year_population_totals_long.asy$Population.type %in% c("REF") , 
                                     c("Value")])
             , -3),  big.mark=",")

totalasy <- format(round(sum(end_year_population_totals_long.asy[end_year_population_totals_long.asy$UNHCRBureau == thisbureau &      end_year_population_totals_long.asy$Year ==lastyear &
                                       end_year_population_totals_long.asy$Population.type %in% c("ASY") , 
                                     c("Value")])
             , -3),  big.mark=",")

totalvda <- format(round(sum(end_year_population_totals_long.asy[end_year_population_totals_long.asy$UNHCRBureau == thisbureau &      end_year_population_totals_long.asy$Year ==lastyear &
                                       end_year_population_totals_long.asy$Population.type %in% c("VDA") , 
                                     c("Value")])
             , -3),  big.mark=",")

totalIDP <- format(round(sum(end_year_population_totals_long.asy[end_year_population_totals_long.asy$UNHCRBureau == thisbureau &      end_year_population_totals_long.asy$Year ==lastyear &
                                       end_year_population_totals_long.asy$Population.type =="IDP" , 
                                     c("Value")])
             , -3),  big.mark=",")

totalooc <- format(round(sum(end_year_population_totals_long.asy[end_year_population_totals_long.asy$UNHCRBureau == thisbureau &      end_year_population_totals_long.asy$Year ==lastyear &
                                       end_year_population_totals_long.asy$Population.type =="OOC" , 
                                     c("Value")])
             , -3),  big.mark=",")

totalsta <- format(round(sum(end_year_population_totals_long.asy[end_year_population_totals_long.asy$UNHCRBureau == thisbureau &      end_year_population_totals_long.asy$Year ==lastyear &
                                       end_year_population_totals_long.asy$Population.type =="STA" , 
                                     c("Value")])
             , -3),  big.mark=",")

totalret <- format(round(sum(solutions_long.asy[solutions_long.asy$UNHCRBureau == thisbureau &
                                                    solutions_long.asy$Year ==lastyear &
                                                    solutions_long.asy$Solution.type =="RET" , 
                                     c("Value")])
             , -3),  big.mark=",")
 
totalretipd <- format(round(sum(solutions_long.asy[solutions_long.asy$UNHCRBureau == thisbureau &
                                                    solutions_long.asy$Year ==lastyear &
                                                    solutions_long.asy$Solution.type =="RDP" , 
                                     c("Value")])
             , -3),  big.mark=",")


totalrett <- format(round(sum(solutions_long.asy[solutions_long.asy$UNHCRBureau == thisbureau &
                                                    solutions_long.asy$Year ==lastyear &
                                                    solutions_long.asy$Solution.type %in% c("RDP","RET") , 
                                     c("Value")])
             , -3),  big.mark=",")

totalrst <- format(round(sum(solutions_long.asy[solutions_long.asy$UNHCRBureau == thisbureau &
                                                    solutions_long.asy$Year ==lastyear &
                                                    solutions_long.asy$Solution.type =="RST" , 
                                     c("Value")])
             , -3),  big.mark=",")


rst.prop <- format(round( 
  sum(solutions_long.asy[solutions_long.asy$UNHCRBureau == thisbureau &      solutions_long.asy$Year ==lastyear &
                                                    solutions_long.asy$Solution.type =="RST" , 
                                     c("Value")]) / 
    sum(end_year_population_totals_long.asy[end_year_population_totals_long.asy$UNHCRBureau == thisbureau &      end_year_population_totals_long.asy$Year ==lastyear&
                                                    solutions_long.asy$Solution.type =="RST"  , 
                                     c("Value")]) 
    
             , 3)*100,  big.mark=",")


totalnat <- format(round(sum(solutions_long.asy[solutions_long.asy$UNHCRBureau == thisbureau &
                                                    solutions_long.asy$Year ==lastyear &
                                                    solutions_long.asy$Solution.type =="NAT" , 
                                     c("Value")])
             , -3),  big.mark=",")

allsol <- format(round(sum(solutions_long.asy[solutions_long.asy$UNHCRBureau == thisbureau &      solutions_long.asy$Year ==lastyear  , 
                                     c("Value")])
             , -3),  big.mark=",")

allsol.prop <- format(round( 
  sum(solutions_long.asy[solutions_long.asy$UNHCRBureau == thisbureau &      solutions_long.asy$Year ==lastyear  , 
                                     c("Value")]) / 
    sum(end_year_population_totals_long.asy[end_year_population_totals_long.asy$UNHCRBureau == thisbureau &      end_year_population_totals_long.asy$Year ==lastyear  , 
                                     c("Value")]) *100
    
             , 3),  big.mark=",")

## Profiles

#Total children below 18

#Hosted in urban/peri-urban areas

```


```{r getdatawb, message=FALSE, warning=FALSE,  echo = FALSE,  include=FALSE, cache = TRUE}
# Population, GDP & GNP per Capita from WorldBank

wb_data <- wbstats::wb( indicator = c("SP.POP.TOTL",  ## Population total https://data.worldbank.org/indicator/SP.POP.TOTL
                                      "NY.GDP.MKTP.CD", ## GDP current https://data.worldbank.org/indicator/NY.GDP.MKTP.CD
                                      "NY.GDP.PCAP.CD", ## GDP per capita https://data.worldbank.org/indicator/NY.GDP.PCAP.CD 
                                      "NY.GNP.PCAP.CD" ## GNI per capita, Atlas method (current US$) https://data.worldbank.org/indicator/NY.GNP.PCAP.CD
                                      ),
                startdate = 1951, enddate = lastyear, return_wide = TRUE)
# # Renaming variables for further matching
names(wb_data)[1] <- "CountryAsylumCode"
names(wb_data)[2] <- "Year"
# write.csv(wb_data, "wb_data.csv", row.names = FALSE)

## getting data from ACLED for events... 
acled.data <- acled.api::acled.api(email.address = Sys.getenv("EMAIL_ADDRESS"),  # see https://developer.acleddata.com/
                                   access.key = Sys.getenv("ACCESS_KEY"),
                                   start.date = "2017-01-01",
                        end.date = lubridate::today(),
                        country = c("Mexico", "Belize", "Honduras",  "Nicaragua", 
                              "Guatemala", "El Salvador", "Costa Rica","Panama" , 
                               "Colombia" , "Venezuela", "Guyana", "Suriname",
                                "Ecuador" , "Bolivia", "Peru" ,  "Brazil",  
                                "Chile", "Argentina", "Paraguay", "Uruguay"),
                        all.variables = TRUE) 

wb_data$yearctr <- paste0(wb_data$CountryAsylumCode, wb_data$Year)
acled.data$yearctr <- paste0(acled.data$iso3, acled.data$year)

## Let's get an average over the last 3 years...


```


:::{.page-break}
:::

# SUMMARY: Key Regional Figures

One in every five persons of concern to UNHCR globally (__`r allpop.prop` %__) live in the __`r thisbureau`__, one of the hardest-hit regions by the pandemic and its socio-economic downturn. As per end `r lastyear` statistical reporting period, the total population of concern in the region is __`r allpop`__. 

This includes: (i)  __`r totalref` Refugees__ (`r allpop.prop.ref` % of global figure), __`r totalasy` Asylum-seekers__ (`r allpop.prop.asy` % of global figure) and  __`r totalvda` Venezuelan Displaced Abroad__ (Venezuelans Displaced Abroad are only reported in the Americas), accounting alltogether for a total of __`r totaldis`Persons__; (ii)  __`r totalIDP` Internally Displaced Persons__ (`r allpop.prop.idp` % of global figure); (iii) __`r totalsta` Total Statelessness __ & (iv)  __`r totalooc` Other of Concerns__. 

The total number of persons of concern increased of more than 20 per cent from 2019, largely linked to an increase of the numbers of persons recorded under "other of concerns" (and more precisely because the inclusion of Host Population in Venezuela & Colombia within that category). .

```{r, message=FALSE, warning=FALSE, comment = "", fig.height=3, size="small", fig.cap = "**| Population of Concern in 2020 in the Americas**"}

# Create data
group <- c("IDPs",
           "Venezuelan Abroad",
           "Asylum Seekers",
           "Refugees",
           "Other of Concerns",
           "Stateless")

valuelastyearworld <- c(as.integer(sum(end_year_population_totals_long.asy[  end_year_population_totals_long.asy$Year ==lastyear &  end_year_population_totals_long.asy$Population.type =="IDP" , 
                                     c("Value")])),
           as.integer(sum(end_year_population_totals_long.asy[  end_year_population_totals_long.asy$Year ==lastyear &  end_year_population_totals_long.asy$Population.type =="VDA" , 
                                     c("Value")])),
           as.integer(sum(end_year_population_totals_long.asy[  end_year_population_totals_long.asy$Year ==lastyear &  end_year_population_totals_long.asy$Population.type =="ASY" , 
                                     c("Value")])),
           as.integer(sum(end_year_population_totals_long.asy[  end_year_population_totals_long.asy$Year ==lastyear &  end_year_population_totals_long.asy$Population.type =="REF" , 
                                     c("Value")])),
           as.integer(sum(end_year_population_totals_long.asy[ end_year_population_totals_long.asy$Year ==lastyear &  end_year_population_totals_long.asy$Population.type =="OOC" , 
                                     c("Value")])),
           as.integer(sum(end_year_population_totals_long.asy[  end_year_population_totals_long.asy$Year ==lastyear &  end_year_population_totals_long.asy$Population.type =="STA" , 
                                     c("Value")]))       )

valuelastyear <- c(as.integer(sum(end_year_population_totals_long.asy[end_year_population_totals_long.asy$UNHCRBureau == thisbureau &  end_year_population_totals_long.asy$Year ==lastyear &  end_year_population_totals_long.asy$Population.type =="IDP" , 
                                     c("Value")])),
           as.integer(sum(end_year_population_totals_long.asy[end_year_population_totals_long.asy$UNHCRBureau == thisbureau &  end_year_population_totals_long.asy$Year ==lastyear &  end_year_population_totals_long.asy$Population.type =="VDA" , 
                                     c("Value")])),
           as.integer(sum(end_year_population_totals_long.asy[end_year_population_totals_long.asy$UNHCRBureau == thisbureau &  end_year_population_totals_long.asy$Year ==lastyear &  end_year_population_totals_long.asy$Population.type =="ASY" , 
                                     c("Value")])),
           as.integer(sum(end_year_population_totals_long.asy[end_year_population_totals_long.asy$UNHCRBureau == thisbureau &  end_year_population_totals_long.asy$Year ==lastyear &  end_year_population_totals_long.asy$Population.type =="REF" , 
                                     c("Value")])),
           as.integer(sum(end_year_population_totals_long.asy[end_year_population_totals_long.asy$UNHCRBureau == thisbureau &  end_year_population_totals_long.asy$Year ==lastyear &  end_year_population_totals_long.asy$Population.type =="OOC" , 
                                     c("Value")])),
           as.integer(sum(end_year_population_totals_long.asy[end_year_population_totals_long.asy$UNHCRBureau == thisbureau &  end_year_population_totals_long.asy$Year ==lastyear &  end_year_population_totals_long.asy$Population.type =="STA" , 
                                     c("Value")]))       )



value2019 <- c(as.integer(sum(end_year_population_totals_long.asy[end_year_population_totals_long.asy$UNHCRBureau == thisbureau &  end_year_population_totals_long.asy$Year ==2019 &  end_year_population_totals_long.asy$Population.type =="IDP" , 
                                     c("Value")])),
           as.integer(sum(end_year_population_totals_long.asy[end_year_population_totals_long.asy$UNHCRBureau == thisbureau &  end_year_population_totals_long.asy$Year ==2019 &  end_year_population_totals_long.asy$Population.type =="VDA" , 
                                     c("Value")])),
           as.integer(sum(end_year_population_totals_long.asy[end_year_population_totals_long.asy$UNHCRBureau == thisbureau &  end_year_population_totals_long.asy$Year ==2019 &  end_year_population_totals_long.asy$Population.type =="ASY" , 
                                     c("Value")])),
           as.integer(sum(end_year_population_totals_long.asy[end_year_population_totals_long.asy$UNHCRBureau == thisbureau &  end_year_population_totals_long.asy$Year ==2019 &  end_year_population_totals_long.asy$Population.type =="REF" , 
                                     c("Value")])),
           as.integer(sum(end_year_population_totals_long.asy[end_year_population_totals_long.asy$UNHCRBureau == thisbureau &  end_year_population_totals_long.asy$Year ==2019 &  end_year_population_totals_long.asy$Population.type =="OOC" , 
                                     c("Value")])),
           as.integer(sum(end_year_population_totals_long.asy[end_year_population_totals_long.asy$UNHCRBureau == thisbureau &  end_year_population_totals_long.asy$Year ==2019 &  end_year_population_totals_long.asy$Population.type =="STA" , 
                                     c("Value")]))       )

colorPopType <- c("#01b399", # IDP 
           "#000000", # VDA
           "#f9ec00", # ASY
           "#0171ba", # REF
           "#153764",# OOC
           "#f04a60") #STA


datatree <- data.frame(group,
                   valuelastyear,
                   value2019,
                   valuelastyearworld,
                   colorPopType)
 
# treemap
# treemap(datatree,
#             index="group",
#             vSize="value",
#             type="index",
#             vColor="color",
#             #type="manual", 
#             #palette = colorPopType,
#             border.col= "white" ,
#             )

## Treemapify

plastyear1 <- ggplot(datatree, 
       aes(area = valuelastyear, 
           fill = group, 
           label = group)) +
  geom_treemap() +
  geom_treemap_text(colour = "white",
                    place = "centre", size = 15) +
 # scale_fill_viridis_c() +
  scale_fill_manual( values = c(   "IDPs" = "#01b399",
                                     "Venezuelan Abroad"="#000000",
                                     "Asylum Seekers" = "#f9ec00",
                                     "Refugees" = "#0171ba",
                                     "Other of Concerns" ="#153764",
                                     "Stateless"="#f04a60")) +
  unhcRstyle::unhcr_theme(base_size = 8)  + ## Insert UNHCR Style
  theme(legend.position = "none") +
  ## and the chart labels
  labs(title = "Population of Concerns in the Americas ",
        subtitle = paste0( lastyear, ", a total of ", format(round(sum(datatree$valuelastyear), -3),  big.mark=","), " Individuals"),
       x = "",
       y = "",
       caption = "Source: UNHCR.org/refugee-statistics  ")

plastyear1

plastyear <- ggplot(datatree, 
       aes(area = valuelastyear, 
           fill = group, 
           label = group)) +
  geom_treemap() +
  geom_treemap_text(colour = "white",
                    place = "centre", size = 15) +
 # scale_fill_viridis_c() +
  scale_fill_manual( values = c(   "IDPs" = "#01b399",
                                     "Venezuelan Abroad"="#000000",
                                     "Asylum Seekers" = "#f9ec00",
                                     "Refugees" = "#0171ba",
                                     "Other of Concerns" ="#153764",
                                     "Stateless"="#f04a60")) +
  unhcRstyle::unhcr_theme(base_size = 8)  + ## Insert UNHCR Style
  theme(legend.position = "none") +
  ## and the chart labels
  labs(#title = "Population of Concerns in the Americas ",
        subtitle = paste0( lastyear, ", a total of ", format(round(sum(datatree$valuelastyear), -3),  big.mark=","), " "),
       x = "",
       y = "",
       caption = " ")

plastyearworld <- ggplot(datatree, 
       aes(area = valuelastyearworld, 
           fill = group, 
           label = group)) +
  geom_treemap() +
  geom_treemap_text(colour = "white",
                    place = "centre", size = 15) +
 # scale_fill_viridis_c() +
  scale_fill_manual( values = c(   "IDPs" = "#01b399",
                                     "Venezuelan Abroad"="#000000",
                                     "Asylum Seekers" = "#f9ec00",
                                     "Refugees" = "#0171ba",
                                     "Other of Concerns" ="#153764",
                                     "Stateless"="#f04a60")) +
  unhcRstyle::unhcr_theme(base_size = 8)  + ## Insert UNHCR Style
  theme(legend.position = "none") +
  ## and the chart labels
  labs(#title = "Population of Concerns in the Americas ",
        subtitle = paste0( lastyear, ", a total of ", format(round(sum(datatree$valuelastyearworld), -3),  big.mark=","), " "),
       x = "",
       y = "",
       caption = " ")


p2019 <- ggplot(datatree, 
       aes(area = value2019, 
           fill = group, 
           label = group)) +
  geom_treemap() +
  geom_treemap_text(colour = "white",
                    place = "centre", size = 15) +
 # scale_fill_viridis_c() +
  scale_fill_manual( values = c(   "IDPs" = "#01b399",
                                     "Venezuelan Abroad"="#000000",
                                     "Asylum Seekers" = "#f9ec00",
                                     "Refugees" = "#0171ba",
                                     "Other of Concerns" ="#153764",
                                     "Stateless"="#f04a60")) +
  unhcRstyle::unhcr_theme(base_size = 8) + ## Insert UNHCR Style
  theme(legend.position = "none") +
  ## and the chart labels
  labs(#title = "Population of Concerns in the Americas ",
       subtitle = paste0("2019, a total of ", format(round(sum(datatree$value2019), -3),  big.mark=","), " "),
       x = "",
       y = "",
       caption = " ")

# library(patchwork)
# patchwork <- p2019 + plastyear
# patchwork +
#   unhcRstyle::unhcr_theme(base_size = 8)  +  ## Insert UNHCR Style
#   theme(legend.position = "none") +
#   plot_annotation(
#     title = 'Significant increase in Key Figures',
#     subtitle = 'Other of concerns category has \n increased in comparison to the 2019',
#     caption = 'Source: UNHCR.org/refugee-statistics '
#   )
# 
# 
# patchwork1 <- plastyear + plastyearworld
# patchwork1 +
#   unhcRstyle::unhcr_theme(base_size = 8)  +  ## Insert UNHCR Style
#   theme(legend.position = "none") +
#   plot_annotation(
#     title = ' ',
#     subtitle = 'Americas',
#     caption = 'Source: UNHCR.org/refugee-statistics '
#   )

```


Finding __solutions__ that enable refugees and other forcibly displaced people to live their lives in dignity and peace is a core part of UNHCR work. They can include voluntary repatriation (aka "_Return_"), resettlement and integration (aka "_Naturalisation_"). There were not any return accounted for this year in the region and  __`r totalrst `__ Resettlement (accounting for __`r rst.prop` %__ of the total recorded resettlement globally this year). Only  __`r totalnat`__ Naturalisation were recorded in the region this year.

In brief, within the Americas the total recorded solutions account for about __`r allsol.prop` %__ of the total number of people of concern to UNHCR.


:::{.page-break}
:::

# INTRODUCTION: About this report

UNHCR [Data Transformation Strategy](https://www.unhcr.org/publications/operations/5dc2e4734/data-transformation-strategy-2020-2025.html) aims at positioning the organisation as a trusted leader on data and information related to refugees and other affected populations. This strategy is designed ensure that UNHCR works in an outward-facing, collaborative and transparent way.

In 2020, in the frame of this vision, UNHCR has established within DIMA unit in each of its Bureau, a team of data analyst and statistician, i.e. functional profiles that were before only established in HQ. In the Americas and in line with global priorities (i.e. the "_3 Common Data Good Initiative_"), the team priorities have focused around:  

 * harmonization and rationalization of Household Survey Exercise: mainstreaming usage of standardized questionnaire modules, rigorous sampling strategy and related SDG Indicators as well as supporting multiple analysis needs (Situation Analysis, Protection Analysis, Severity Analysis & Vulnerability analysis) from the same data collection exercise.
 * dissemination of International Recommendations on Refugees and IDPs Statistics among National Statistical Office;
 * capacity building of staff both in terms of data literacy and advanced statistical analysis (for instance for vulnerability scoring).


This report is the first edition of a projected annual series, looking at detailed analysis of all publicly available figures. The report also aims to highlight statistical challenges that needs to be addressed (and potential solutions!) to improve the quality of the data we have.

Charts and graphs in the reports have been prepared using a fully [reproducible analysis](https://unhcr-americas.github.io/reproducibility/index.html#1) approach so that they can be easily re-used whenever needed in fact-sheet, talking points or report. The team is also available to revise  the content below or build additional charts.


:::{.page-break}
:::

# PART I: Regional Analysis 

## Most movement remains south-to-south

The following chart visualizes population movements between source and destination countries in the region for Refugees, Asylum Seekers and Venezuelan Displaced Abroad. For better visualization, countries accounting for less than 2% of the total population were lumped together as "Other". This initial visualization gives a good idea of the magnitude of the displacement from Venezuela within the continent.

There are also population inflow from other regions but they remains diverse with the exception of persons from China that appears in the chart below even when applying the 2% threshold. 

```{r pop-flows, message=FALSE, warning=FALSE, comment = "", fig.height=5, size="small", fig.cap = "**| Population origin-destination in the region**"}

## https://jokergoo.github.io/circlize_book/book/

library(tidyverse)
library(dplyr)
chords <- end_year_population_totals %>%
  dplyr::left_join( unhcrdatapackage::reference %>% 
                      select(coa_region = `UNHCRBureau`, iso_3),  by = c("CountryAsylumCode" = "iso_3")) %>% 
  filter(coa_region == thisbureau & Year == lastyear) %>% 
  dplyr::mutate(across(REF:VDA, ~replace_na(as.numeric(.), 0)),
         total = REF + ASY + VDA, #+ IDP  + STA + OOC,
         # Lump together factor levels into "other"
         CountryAsylumName = forcats::fct_lump_prop(CountryAsylumName, prop = .02, w = total),
         CountryOriginName = forcats::fct_lump_prop(CountryOriginName, prop = .02, w = total)) %>% 
   group_by(CountryOriginName, CountryAsylumName) %>%
   summarize(total = sum(total), .groups = "drop")  %>%
# CountryOriginName = fct_recode(CountryOriginName, "Other" = "China")
  mutate(CountryOriginName = str_replace(CountryOriginName, " \\(Bolivarian Republic of\\)", ""),
        CountryAsylumName = str_replace(CountryAsylumName, " \\(Bolivarian Republic of\\)", ""),
        CountryOriginName = str_replace(CountryOriginName, " \\(Plurinational State of\\)", ""),
        CountryAsylumName = str_replace(CountryAsylumName, " \\(Plurinational State of\\)", ""),
        CountryOriginName = str_replace(CountryOriginName, "United States of America", "USA"),
        CountryAsylumName = str_replace(CountryAsylumName, "United States of America", "USA"))

circlize::chordDiagram(chords,
                       self.link = 1,
                       grid.col = colorRampPalette(RColorBrewer::brewer.pal(11, "Paired"))(15),
                       annotationTrack = "grid" ,
                     # preAllocateTracks = list(track.height = max(strwidth(unlist(dimnames(chords))))),
                      preAllocateTracks = 1.6
)

circos.track(track.index = 1,
             panel.fun = function(x, y) {
               circos.text(CELL_META$xcenter,
                           CELL_META$ylim[1],
                           CELL_META$sector.index,
                           facing = "clockwise",
                           niceFacing = TRUE,
                           adj = c(0, 0.5))
             },
             bg.border = NA) # here set bg.border to NA is important


title(main = "Movement of Forcibly Displaced Population")

```

The evolution in the last 20 years shows a significant increase in Internally Displaced Persons, an element specifically linked to the population in Colombia. In the last five years, the number of Asylum-seekers also  substantially increased. while the number of Refugees remained relatively stationary over time. Finally, the category Other of Concerns has seen a sharp increase and reflects the growing complexity of displacement crisis in the region (involving population at risk of displacement, host population and mixed movements...). 

```{r ,message = FALSE, warning = FALSE,fig.height=6, size="small", fig.cap = "**| Evolution over time of the different Population of Concern**"}

#Prepare data
multiple_line_df <- end_year_population_totals_long.asy %>%
  filter(UNHCRBureau  == thisbureau &
           !(is.na(UNHCRBureau))) %>%
  group_by(Year, Population.type, Population.type.label ) %>%
  summarise(Value2 = sum(Value) ) 

#Make plot
ggplot(multiple_line_df, aes(x = Year, y = Value2, 
                                              colour = Population.type)) + # Adding reference to color
  geom_line(size = 1) + # Here we mention that it will be a line chart
    # stat_smooth(size=1.5, 
    #           method = "loess", 
    #           level = 0.95, 
    #           fullrange = TRUE, 
    #           se = FALSE) + 
  
  geom_hline(yintercept = 0, size = 1.1, colour = "#333333") +
  scale_y_continuous( label = format_si()) + ## Format axis number
  
  xlim(c(2000, lastyear + 7)) +
  
  #scale_colour_viridis_d() + ## Add color for each lines based on color-blind friendly palette
  scale_colour_manual( values = c( "REF" = "#a6cee3",
                                                      "ASY"  = "#1f78b4",
                                                     "IDP" = "#b2df8a",
                                                     "STA" = "#33a02c",
                                                      "OOC" = "#fb9a99",
                                                      "VDA" = "#e31a1c")) +
  geom_label(aes(x = lastyear + .5 ,
                 y = as.numeric(multiple_line_df[multiple_line_df$Population.type == "REF" & multiple_line_df$Year == lastyear , c("Value2")]),
                 label = "Refugees"),
                             hjust = 0,
                             vjust = 0.5,
                             colour = "#a6cee3",
                             fill = "white",
                             label.size = NA,
                             family = "Lato",
                             size = 4) +
   geom_label(aes(x = lastyear +.5,
                  y = as.numeric(multiple_line_df[multiple_line_df$Population.type == "ASY" & multiple_line_df$Year == lastyear , c("Value2")]),
                  label = "Asylum Seekers"),
                             hjust = 0,
                             vjust = 0.5,
                             colour = "#1f78b4",
                             fill = "white",
                             label.size = NA,
                             family = "Lato",
                             size = 4) +
   geom_label(aes(x = lastyear + .5,
                  y = as.numeric(multiple_line_df[multiple_line_df$Population.type == "IDP" & multiple_line_df$Year == lastyear , c("Value2")]),
                   label = "Internally Displaced \n Persons"),
                             hjust = 0,
                             vjust = 0.5,
                             colour = "#b2df8a",
                             fill = "white",
                             label.size = NA,
                             family = "Lato",
                             size = 4) +
    geom_label(aes(x = lastyear + .5,
                  y = as.numeric(multiple_line_df[multiple_line_df$Population.type == "STA" & multiple_line_df$Year == lastyear , c("Value2")]),
                    label = "Statelessness"),
                             hjust = 0,
                             vjust = 0.5,
                             colour = "#33a02c",
                             fill = "white",
                             label.size = NA,
                             family = "Lato",
                             size = 4) +
    geom_label(aes(x = lastyear + .5,
                  y = as.numeric(multiple_line_df[multiple_line_df$Population.type == "OOC" & multiple_line_df$Year == lastyear , c("Value2")]),
                    label = "Other of Concerns"),
                             hjust = 0,
                             vjust = 0.5,
                             colour = "#fb9a99",
                             fill = "white",
                             label.size = NA,
                             family = "Lato",
                             size = 4) +
    geom_label(aes(x = lastyear + .5,
                  y = as.numeric(multiple_line_df[multiple_line_df$Population.type == "VDA" & multiple_line_df$Year == lastyear , c("Value2")]),
                    label = "Venezuelan Displaced \n Abroad"),
                             hjust = 0,
                             vjust = 0.5,
                             colour = "#e31a1c",
                             fill = "white",
                             label.size = NA,
                             family = "Lato",
                             size = 4) +
  
  unhcRstyle::unhcr_theme(base_size = 8)  + ## Insert UNHCR Style
  theme(legend.position = "none",
        panel.grid.major.y  = element_line(color = "#cbcbcb"), 
        panel.grid.major.x  = element_blank(), 
        panel.grid.minor = element_blank()) + ### changing grid line that should appear
  ## and the chart labels
  labs(title = "Forcible Displacement in the Americas ",
       subtitle = "Evolution in the past 20 years",
       x = " ",
       y = " ",
       caption = "Source: UNHCR.org/refugee-statistics ")

```


:::{.bg-blue}
__Venezuelan Displaced Abroad is relatively new category for UNHCR__
According to interviews and protection monitoring exercises conducted by UNHCR and partners, Venezuelans claim that they are leaving the country for a variety of reasons, including persecution on account of their individual profiles, insecurity and violence, lack of access to food, medicine and essential services, as well as loss of income as a result of the current human rights, political and socioeconomic situation in Venezuela. Based on these reports, as well as reliable information in the public domain from a wide range of sources about the situation in Venezuela, UNHCR considers that for a number of profiles, international protection considerations are likely to arise under the 1951 Convention/1967 Protocol relating to the Status of Refugees depending on the circumstances of the individual case. While individual circumstances and reasons for departure from Venezuela vary, UNHCR considers that the majority of Venezuelan nationals, or stateless persons who were habitually resident in Venezuela, are in need of international protection under the criteria contained in the Cartagena Declaration on the basis of threats to their lives, security or freedom resulting from the events that are currently seriously disturbing public order in Venezuela.
:::

```{r message = FALSE, warning = FALSE, comment = "", fig.height=5, size="small", fig.cap = "**| Bar Evolution over time of the different Population of Concern**"}
# # Plot
# ggplot(multiple_line_df, aes(x = Year, y = Value2, fill=Population.type.label)) + 
#     #geom_area(alpha=0.6 , size=.5, colour="white") +
#     geom_bar(position="stack", stat="identity") + 
#     viridis::scale_fill_viridis(discrete = T) + 
#   geom_hline(yintercept = 0, size = 1.1, colour = "#333333") +
#   scale_y_continuous( label = format_si()) + ## Format axis number
#   unhcRstyle::unhcr_theme(base_size = 8)  + ## Insert UNHCR Style
#   
#   ## and the chart labels
#   labs(title = "Forcible Displacement in the Americas ",
#        subtitle = "Evolution in the past 20 years",
#        x = "",
#        y = "",
#        caption = "Source: UNHCR.org/refugee-statistics ")
```

Colombia remains the country that both host the largest number of displaced population (either across borders or internally).
 
```{r message=FALSE, warning=FALSE, comment = "", fig.height=5, size="small",  fig.cap = "**| Largest Countries of Asylum**"}

# 1.  WE NEED DATA DISAGREGATED BY Total Refugees, Asylum-seekers & Venezuelan Displaced Abroad
# 2. tHE GRAPHS OF THE COUNTRIES ARE ON 5 YEARS BUT THE TITLE SAIS 20. IS THE EVOLUTION OF LAST 5 YEARS AND NOT 20. pLEASE CHECK THE TITLE

#Prepare data2
bar_df <- end_year_population_totals_long.asy %>%
  filter(Population.type  %in% c("REF","ASY","VDA") & 
           Year == lastyear &
           UNHCRBureau  == thisbureau &
           !(is.na(UNHCRBureau))) %>%
  group_by( CountryAsylumName#, Population.type
            ) %>%
  summarise(Value2 = sum(Value) )  %>%
  #mutate( value3 =  format_si(Value2)) %>%
  arrange(desc(Value2)) %>%
  head(10)    


#Make plot
ggplot(bar_df, aes(x = reorder(CountryAsylumName, Value2), ## Reordering country by Value
                   y = Value2)) +
  geom_bar(stat = "identity", 
           position = "identity", 
           fill = "#0072bc"
           ) + # here we configure that it will be bar chart+
  #facet_wrap( vars(Population.type), ncol = 3) +
  geom_text(#bar_df, 
             aes(x =reorder(CountryAsylumName, Value2), ## Reordering country by Value
                 y = Value2,
                label =  ifelse( Value2 < 0.2*max(Value2), "", paste0(format(round(Value2, -3),  big.mark=",")))),
             hjust=1 , colour = "white") +
  # geom_label(aes(x = CountryAsylumName, y = Value2, 
  #               label =  format(round(Value2, -3),  big.mark=","), 
  #            colour = ifelse(test = Value2 > 400000, "white", "black"), 
  #            hjust = ifelse(test = Value2 > 400000, -0.5, 0.5)), 
  #            #hjust = 1, 
  #            vjust = 0.5, 
  #            #colour = "white",
  #            fill = NA, 
  #            label.size = NA, 
  #            family = "Lato", 
  #            size = 6) +
  coord_flip() + # Add `coord_flip()` to make your vertical bars horizontal:
  ## and the chart labels
  labs(title = "Except for the US, most displacement in the region is linked to Venezuelan Abroad ",
       subtitle = paste0("Refugee, Asylum Seekers & Venezuelan Abroad in ",lastyear), 
       x = "",
       y = "",
       caption = "Top 10 Countries, Source: UNHCR.org/refugee-statistics/") +
  scale_y_continuous( label = format_si()) + ## Format axis number
  geom_hline(yintercept = 0, size = 1.1, colour = "#333333") +
  unhcRstyle::unhcr_theme(base_size = 8)  + ## Insert UNHCR Style
  theme(panel.grid.major.x = element_line(color = "#cbcbcb"), 
        panel.grid.major.y = element_blank()) ### changing grid line that should appear
```


When looking at other population types that did not cross a borders (i.e. other of Concerns & IDPs), obviously the situation of IDPs in Colombia stands out clearly. The second place though is also taken by "Other of Concerns" in Colombia, a figure that indeed includes 787,450 Host Community members and also returnee Colombians from Venezuela.


```{r message=FALSE, warning=FALSE, comment = "", fig.height=5, size="small",  fig.cap = "**| Other Displacement**"}
#Prepare data2
bar_df <- end_year_population_totals_long.asy %>%
  filter(Population.type  %in% c("IDP","OOC","STA") & 
           Year == lastyear &
           UNHCRBureau  == thisbureau &
           !(is.na(UNHCRBureau))) %>%
  group_by( CountryAsylumName, Population.type) %>%
  summarise(Value2 = sum(Value) )  %>%
  #mutate( value3 =  format_si(Value2)) %>%
  arrange(desc(Value2)) %>%
  mutate(CountryAsylumName = str_replace(CountryAsylumName, " \\(Bolivarian Republic of\\)", ""),
        CountryAsylumName = str_replace(CountryAsylumName, " \\(Plurinational State of\\)", ""),
        CountryAsylumName = str_replace(CountryAsylumName, "United States of America", "USA")) %>%
  head(10)


#Make plot
ggplot(bar_df, aes(x = reorder(paste0(CountryAsylumName,"-",Population.type), Value2),
                           y = Value2)) +
  geom_bar(stat = "identity", 
           position = "identity", 
           fill = "#0072bc") + # here we configure that it will be bar chart+
  
  # geom_text(#bar_df, 
  #            aes(x =reorder(paste0(CountryAsylumName,"-",Population.type), Value2), 
  #                y = Value2,
  #               label =  ifelse( Value2 < 0.05*max(Value2), "", paste0(format(round(Value2, -3),  big.mark=",")))),
  #            hjust=1 , colour = "white", family = "Lato", size = 2) +
  geom_label(aes(x = reorder(paste0(CountryAsylumName,"-",Population.type), Value2),
                 y = Value2,
                label =  format(round(Value2, -3),  big.mark=",")),
             hjust = 0,
             vjust = 0.5,
             colour = "black",
             fill = NA,
             label.size = NA,
             family = "Lato",
             size = 4) +
  
  
  geom_hline(yintercept = 0, size = 1.1, colour = "#333333") +
  coord_flip() + # Add `coord_flip()` to make your vertical bars horizontal:
  ## and the chart labels
  labs(title = "Countries with _within borders_ concerns in the Americas",
       subtitle = paste0("IDPs, Statelessness & Other of Concern in ",lastyear), 
       x = "",
       y = "",
       caption = "Top 10 Countries, Source: UNHCR.org/refugee-statistics/") +
  scale_y_continuous( label = format_si(),
                      limits=c(0, 10000000))  + ## Format axis number
  unhcRstyle::unhcr_theme(base_size = 8)  + ## Insert UNHCR Style
  theme(panel.grid.major.x = element_line(color = "#cbcbcb"), 
        panel.grid.major.y = element_blank()) ### changing grid line that should appear
```




:::{.page-break}
:::
## Displacement and (Perception of...) Violence 

Forced displacement as a result of conflict, violence, and other causes undermine sustainable development ( namely _Goal 10: Reduce inequality within and among countries_), and can increase the risk of regional instability, especially when refugees are hosted in neighboring countries, resulting in possible tensions with local populations. 



:::{.page-break}
:::

## Processing of Refugee Status Determination   

Around `r allpop.prop.asy` % of all Asylum-seekers globally are actually accounted for in the Americas. As part of statistics collection, UNHCR collate information on Refugee Status Determination (RSD) applications. RSD are important as they often represent the first step to long term solution.

It is important to recall that those represents "applications" (not applicants!) and therefore interpretation of those data should account for potential built-in double count, specifically for the US where multiple procedures can actually be initiated in parallel 


Most RSD applications comes from Venezuelan. Other relevant country of origin are: Nicaragua, Mexico, Honduras, Haiti, Guatemala, El Salvador and Cuba. Again the Central America countries are the most relevant. Most RSD activities occurs in the US. Traditionally, Canada has relevant RSD activities as well. Mexico, Brazil and Costa Rica become for different reason important is RSD applications.

```{r echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=5, size="small",  fig.cap = "**| Number of Status Determination Decision par Asylum Country in 2020**"}
topasyl <-  asylum_decisions %>%
  ## Add reference for the filters
  dplyr::left_join( unhcrdatapackage::reference %>% 
                      select(coa_region = `UNHCRBureau`, iso_3),  by = c("CountryAsylumCode" = "iso_3")) %>% 
  filter(coa_region == thisbureau & Year == lastyear) %>% 
 # select(region_asy, ctry_asy, year, recognizedConvMandate, recognizedOther, appliedDuringTheYear, meta_applicationAveragePersonsPerCase) %>%
  mutate(DecisionsAveragePersonsPerCase = map_dbl(DecisionsAveragePersonsPerCase, ~replace_na(max(as.numeric(.), 1), 1))) %>%
  group_by(CountryAsylumName) %>% 
  summarize(Recognized = sum(Recognized * DecisionsAveragePersonsPerCase, na.rm = TRUE),
            ComplementaryProtection = sum(ComplementaryProtection * DecisionsAveragePersonsPerCase, na.rm = TRUE),
            TotalDecided = sum(TotalDecided * DecisionsAveragePersonsPerCase, na.rm = TRUE)) %>%
  mutate(RefugeeRecognitionRate = (Recognized ) / TotalDecided,
         GlobalRecognitionRate = (Recognized + ComplementaryProtection) / TotalDecided ) %>%
  filter(TotalDecided  != 0) %>%
  filter(TotalDecided  > 1000)  %>%
  mutate(CountryAsylumName = str_replace(CountryAsylumName, "United States of America", "USA"))
  
#topasyl1 <-  topasyl  %>%
  
 
rsdasyl <-  ggplot(topasyl, aes(y = TotalDecided, 
             x = reorder(CountryAsylumName, TotalDecided))) + 
  scale_y_continuous(labels = format_si()) +
  #facet_grid(.~ ctry_asy) +  
  geom_bar( stat ="identity", fill = unhcRstyle::unhcr_blue) +
  coord_flip() +
  labs(#title = "Number of RSD application  in 2020",
       subtitle = "Per country of asylum",
       x = " ", 
       y = " "  ) +
  unhcRstyle::unhcr_theme(base_size = 9) +
  theme(#axis.text.x = element_blank(),
    # legend.position = "none",
    
    panel.grid.major.x = element_line(color = "#cbcbcb"), 
    panel.grid.major.y = element_blank()) +### changing grid line that should appear) +
  geom_hline(yintercept = 0, size = 1.1, colour = "#333333") 
  
##############################################################
##############################################################
  
topOrigin <-  asylum_decisions %>%
  ## Add reference for the filters
  dplyr::left_join( unhcrdatapackage::reference %>% 
                      select(coa_region = `UNHCRBureau`, iso_3),  by = c("CountryOriginCode" = "iso_3")) %>% 
  filter(coa_region == thisbureau & Year == lastyear) %>% 
 # select(region_asy, ctry_asy, year, recognizedConvMandate, recognizedOther, appliedDuringTheYear, meta_applicationAveragePersonsPerCase) %>%
  mutate(DecisionsAveragePersonsPerCase = map_dbl(DecisionsAveragePersonsPerCase, ~replace_na(max(as.numeric(.), 1), 1))) %>%
  group_by(CountryOriginName) %>% 
  summarize(Recognized = sum(Recognized * DecisionsAveragePersonsPerCase, na.rm = TRUE),
            ComplementaryProtection = sum(ComplementaryProtection * DecisionsAveragePersonsPerCase, na.rm = TRUE),
            TotalDecided = sum(TotalDecided * DecisionsAveragePersonsPerCase, na.rm = TRUE)) %>%
  mutate(RefugeeRecognitionRate = (Recognized ) / TotalDecided,
         GlobalRecognitionRate = (Recognized + ComplementaryProtection) / TotalDecided) %>%
  filter(TotalDecided  != 0) %>%
  filter(TotalDecided  > 1000)  %>%
  mutate(CountryOriginName = str_replace(CountryOriginName, " \\(Bolivarian Republic of\\)", ""))
  
 
rsdorigin <- ggplot(topOrigin, aes(y = TotalDecided, 
             x = reorder(CountryOriginName, TotalDecided))) + 
  scale_y_continuous(labels = format_si()) +
  #facet_grid(.~ ctry_asy) +  
  geom_bar( stat ="identity", fill = unhcRstyle::unhcr_blue) +
  coord_flip() +
  labs(#title = "Number of RSD application per country of Origin in 2020",
       subtitle = "Per country of Origin",
       x = " ", 
       y = " " ) +
  unhcRstyle::unhcr_theme(base_size = 9) +
  theme(#axis.text.x = element_blank(),
    # legend.position = "none",
    
    panel.grid.major.x = element_line(color = "#cbcbcb"), 
    panel.grid.major.y = element_blank()) +### changing grid line that should appear) +
  geom_hline(yintercept = 0, size = 1.1, colour = "#333333")  


##########################
#joining charts
##################
library(patchwork)
patchworkRSDa <- rsdasyl + rsdorigin
patchworkRSDa +
  #unhcRstyle::unhcr_theme(base_size = 8)  +  ## Insert UNHCR Style
  theme(legend.position = "none") +
  plot_annotation(
    title = 'Number of RSD applications in 2020  ',
   # subtitle = ' ',
    caption = 'Source: UNHCR.org/refugee-statistics - Only Countries of Origin with more than 1,000 application during 2020 -\n Because of different types of procedure, data from the US may includes multiple applications per applicants compared to other countries '
  )  
  
```

Most RSD applications comes from Venezuelan, Colombians and Central America people. Honduras, El Salvador, Nicaragua, Guatemala, Mexico Cuba and Haiti people together have more RSD applications than Venezuelan.

Looking at the decision process, we can see that the level of recognition varies widely depending both on the country of Asylum and on the country of Origin. Brazil, Ecuador, Peru and Mexico have higher Refugee Recognition Rate (RRR) in Americas.

:::{.bg-blue}
The __Refugee Recognition Rate (RRR)__ divides the number of asylum-seekers granted Convention refugee status by the total number of accepted (Convention and, where relevant, humanitarian status) and rejected cases. 
The __Total Recognition Rate (TRR)__ divides the number of asylum-seekers granted Convention refugee status and humanitarian status by the total number of accepted (Convention and, where relevant, humanitarian status) and rejected cases. Non-substantive decisions are, to the extent possible, excluded from both calculations. 

For the purpose of international comparability, UNHCR only uses these two recognition rates and does not report nationally calculated rates, for instance rates disaggregated by RSD stage (1st instance vs. appeal), and by internal processing agency within the country or specific calculations potentially skewing the perception such as recognized/(recognized+rejected) instead of recognized/decided.  
:::


```{r echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=5, size="small",  fig.cap = "**| Refugee Recognition rate in 2020**"}
recoasyl <- ggplot(topasyl, aes(y = RefugeeRecognitionRate, 
             x = reorder(CountryAsylumName, RefugeeRecognitionRate))) + 
  scale_y_continuous(labels = scales::label_percent(accuracy = .01)) +
  #facet_grid(.~ ctry_asy) +  
  geom_bar( stat ="identity", fill = unhcRstyle::unhcr_blue) +
  coord_flip() +
  labs(#title = " ",
       subtitle = "Per country of asylum",
       x = " ", 
       y = " " ) +
  unhcRstyle::unhcr_theme(base_size = 9) +
  theme(#axis.text.x = element_blank(),
     # legend.position = "none",
    panel.grid.major.x = element_line(color = "#cbcbcb"), 
    panel.grid.major.y = element_blank()) + ### changing grid line  
  geom_hline(yintercept = 0, size = 1.1, colour = "#333333")  

## Filter top 10 

#topOrigin <- topOrigin <- 

recoorigin <- ggplot(topOrigin, aes(y = RefugeeRecognitionRate, 
             x = reorder(CountryOriginName, RefugeeRecognitionRate))) + 
  scale_y_continuous(labels = scales::label_percent(accuracy = .01)) +
  #facet_grid(.~ ctry_asy) +  
  geom_bar( stat ="identity", fill = unhcRstyle::unhcr_blue) +
  coord_flip() +
  labs(#title = " ",
       subtitle = "Per country of Origin ",
       x = " ", 
       y = " " ) +
  unhcRstyle::unhcr_theme(base_size = 9) +
  theme(#axis.text.x = element_blank(),
     # legend.position = "none",
    panel.grid.major.x = element_line(color = "#cbcbcb"), 
    panel.grid.major.y = element_blank() ) + ### changing grid line  
  geom_hline(yintercept = 0, size = 1.1, colour = "#333333") 

##########################
#joining charts
##################
library(patchwork)
patchworkRSD <- recoasyl + recoorigin
patchworkRSD +
 # unhcRstyle::unhcr_theme(base_size = 8)  +  ## Insert UNHCR Style
  theme(legend.position = "none") +
  plot_annotation(
    title = 'Refugee Recognition Rate Comparison in 2020 ',
   # subtitle = ' ',
    caption = 'Source: UNHCR.org/refugee-statistics - Only Countries of Origin with more than 1,000 application during 2020 -\n Because of different types of procedure, data from the US may includes multiple applications per applicants compared to other countries  '
  )


```

And for the minority of Venezuelan that can go through this process, the recognition rate is the actually the highest among other country of origin in the region. Central America people have good Refugee Recognition Rate (especially Honduras, Nicaragua, El Salvador, Cuba, Guatemala, Haiti and Mexico).

This chart shows the RSD procedures in Americas. Below the same graphs by country are reproduced.  From left to the right: The first line represent the nationalities of the RSD applications. The second vertical line represent the institution where the RSD people applies: in Americas people applied mostly to the government, and sometimes directly to UNHCR. The third line describes the stage of the RSD applications (the process is different in every country). The forth and last vertical line shows the results of the RSD applications.

```{r message=FALSE, warning=FALSE, comment = "", fig.height=5, size="small", fig.cap = "**| Asylum Application in 2020**"}
## Check rendering here - https://stackoverflow.com/questions/54987281/sankey-network-within-r-blogdown-wont-render-properly-on-firefox 

htmlwidgets::onStaticRenderComplete('$.each( document.getElementsByTagName("svg"), function( index, value ){value.setAttribute("viewBox", null);});')


linksApplication.Ori.Procedure <- asylum_applications %>%
                    ## Add reference for the filters
                    dplyr::left_join( unhcrdatapackage::reference %>% 
                                        select(coa_region = `UNHCRBureau`, iso_3),  by = c("CountryAsylumCode" = "iso_3")) %>% 
                    filter(coa_region == thisbureau & Year == lastyear) %>% 
                    ## Group small records under other
                    mutate(CountryOriginName = forcats::fct_lump_prop(CountryOriginName, prop = .01, w = NumberApplications)) %>% 
                    mutate(CountryOriginName = str_replace(CountryOriginName, " \\(Bolivarian Republic of\\)", ""))%>% 
                    ## Calculate grouped value for Origin to procedure..
                    group_by(CountryOriginName, ProcedureName ) %>%
                    summarise(value = sum(NumberApplications) ) %>%
                    ## Rename variable
                    rename(source = CountryOriginName) %>%
                    rename(target = ProcedureName) 

linksApplication.Procedure.Type <- asylum_applications %>%
  ## Add reference for the filters
  dplyr::left_join( unhcrdatapackage::reference %>% 
                      select(coa_region = `UNHCRBureau`, iso_3),  by = c("CountryAsylumCode" = "iso_3")) %>% 
  filter(coa_region == thisbureau & Year == lastyear) %>% 
  ## Group small records under other
  ## Calculate grouped value for Origin to procedure..
  group_by(ProcedureName, ApplicationType ) %>%
  summarise(value = sum(NumberApplications) ) %>%
  ## Rename variable
  rename(source = ProcedureName) %>%
  rename(target = ApplicationType) 

linksApplication.Type.Asylum <- asylum_applications %>%
  ## Add reference for the filters
  dplyr::left_join( unhcrdatapackage::reference %>% 
                      select(coa_region = `UNHCRBureau`, iso_3),  by = c("CountryAsylumCode" = "iso_3")) %>% 
  filter(coa_region == thisbureau & Year == lastyear) %>% 
  ## Group small records under other
  mutate(CountryAsylumName = forcats::fct_lump_prop(CountryAsylumName, prop = .01, w = NumberApplications)) %>% 
  mutate(CountryAsylumName = str_replace(CountryAsylumName, " \\(Bolivarian Republic of\\)", ""))%>% 
  
  mutate(CountryAsylumName = paste0("Asylum in ", CountryAsylumName)) %>% 
  ## Calculate grouped value for Origin to procedure..
  group_by(ApplicationType, CountryAsylumName) %>%
  summarise(value = sum(NumberApplications) ) %>%
  ## Rename variable
  rename(source = ApplicationType) %>%
  rename(target = CountryAsylumName) 

linksallApplication <- rbind(linksApplication.Ori.Procedure,
                  linksApplication.Procedure.Type,
                  linksApplication.Type.Asylum)



# From these flows we need to create a node data frame: it lists every entities involved in the flow
nodesApplication <- data.frame(
  name=c(as.character(linksallApplication$source), 
         as.character(linksallApplication$target)) %>% unique()
)

# With networkD3, connection must be provided using id, not using real name like in the links dataframe.. So we need to reformat it.
linksallApplication$IDsource <- match(linksallApplication$source, nodesApplication$name)-1 
linksallApplication$IDtarget <- match(linksallApplication$target, nodesApplication$name)-1

# Make the Network
p <- networkD3::sankeyNetwork(Links = linksallApplication, 
                              Nodes = nodesApplication,
                              Source = "IDsource", 
                              Target = "IDtarget",
                              Value = "value", 
                              NodeID = "name", 
                              # LinkGroup	 character string specifying the groups in the Links. Used to color the links in the network.
                              sinksRight=FALSE) ##  If TRUE, the last nodes are moved to the right border of the plot.
#p

# you save it as an html
networkD3::saveNetwork(p, "graph/application.html")

# you convert it as png -- Need first webshot::install_phantomjs()
webshot::webshot(paste0(getwd(),"/graph/application.html"),paste0(getwd(),"/graph/application.png"), vwidth = 800, vheight = 500)
#getwd()
# ![ ](graph/application.png)

```




This chart shows the RSD decisions are issued in Americas.  From left to the right: The first line represent the nationalities of the RSD applications. The second vertical line represent the institution where the RSD people applies: in Americas people applied mostly to the government, and sometimes directly to UNHCR. The third line describes how it is issued the RSD applications. The forth line the results of the RSD applications.And the fifth and last vertical line shows where the asylium is issued.  

Most RSD applications comes from Venezuelan (first line on the left). Most of the asylium activity is issued by USA, Canada, Brazil, Costa Rica and Mexico

```{r message=FALSE, warning=FALSE, comment = "", fig.height=7, size="small", fig.cap = "**| Asylum Decision in 2020**"}
linksDecision.Ori.Procedure <- asylum_decisions_long %>%
  ## Add reference for the filters
  dplyr::left_join( unhcrdatapackage::reference %>% 
                      select(coa_region = `UNHCRBureau`, iso_3),  by = c("CountryAsylumCode" = "iso_3")) %>% 
  filter(coa_region == thisbureau & Year == lastyear) %>% 
  ## Group small records under other
  mutate(CountryOriginName = forcats::fct_lump_prop(CountryOriginName, prop = .01, w = Value)) %>% 
  mutate(CountryOriginName = str_replace(CountryOriginName, " \\(Bolivarian Republic of\\)", "")) %>% 
  ## Calculate grouped value for Origin to procedure..
  group_by(CountryOriginName, ProcedureName ) %>%
  summarise(value = sum(Value) ) %>%
  ## Rename variable
  rename(source = CountryOriginName) %>%
  rename(target = ProcedureName) 

linksDecision.Procedure.Type <- asylum_decisions_long %>%
  ## Add reference for the filters
  dplyr::left_join( unhcrdatapackage::reference %>% 
                      select(coa_region = `UNHCRBureau`, iso_3),  by = c("CountryAsylumCode" = "iso_3")) %>% 
  filter(coa_region == thisbureau & Year == lastyear) %>% 
  ## Group small records under other
  ## Calculate grouped value for Origin to procedure..
  group_by(ProcedureName, DecisionTypeName ) %>%
  summarise(value = sum(Value) ) %>%
  ## Rename variable
  rename(source = ProcedureName) %>%
  rename(target = DecisionTypeName) 

linksDecision.Type.Output <- asylum_decisions_long %>%
  ## Add reference for the filters
  dplyr::left_join( unhcrdatapackage::reference %>% 
                      select(coa_region = `UNHCRBureau`, iso_3),  by = c("CountryAsylumCode" = "iso_3")) %>% 
  filter(coa_region == thisbureau & Year == lastyear) %>% 
  ## Group small records under other
  ## Calculate grouped value for Origin to procedure..
  group_by(DecisionTypeName,Decision.output ) %>%
  summarise(value = sum(Value) ) %>%
  ## Rename variable
  rename(source = DecisionTypeName) %>%
  rename(target = Decision.output)

linksDecision.output.Asylum <- asylum_decisions_long %>%
  ## Add reference for the filters
  dplyr::left_join( unhcrdatapackage::reference %>% 
                      select(coa_region = `UNHCRBureau`, iso_3),  by = c("CountryAsylumCode" = "iso_3")) %>% 
  filter(coa_region == thisbureau & Year == lastyear) %>% 
  ## Group small records under other
  mutate(CountryAsylumName = forcats::fct_lump_prop(CountryAsylumName, prop = .01, w = Value)) %>% 
  mutate(CountryAsylumName = str_replace(CountryAsylumName, " \\(Bolivarian Republic of\\)", ""))%>% 
  
  mutate(CountryAsylumName = paste0("Asylum in ", CountryAsylumName)) %>% 
  ## Calculate grouped value for Origin to procedure..
  group_by(Decision.output, CountryAsylumName) %>%
  summarise(value = sum(Value) ) %>%
  ## Rename variable
  rename(source = Decision.output) %>%
  rename(target = CountryAsylumName) 

linksallDecision <- rbind(linksDecision.Ori.Procedure,
                  linksDecision.Procedure.Type,
                  linksDecision.Type.Output,
                  linksDecision.output.Asylum)



# From these flows we need to create a node data frame: it lists every entities involved in the flow
nodesDecision <- data.frame(
  name=c(as.character(linksallDecision$source), 
         as.character(linksallDecision$target)) %>% unique()
)

# With networkD3, connection must be provided using id, not using real name like in the links dataframe.. So we need to reformat it.
linksallDecision$IDsource <- match(linksallDecision$source, nodesDecision$name)-1 
linksallDecision$IDtarget <- match(linksallDecision$target, nodesDecision$name)-1

# Make the Network
p <- networkD3::sankeyNetwork(Links = linksallDecision, 
                              Nodes = nodesDecision,
                              Source = "IDsource", 
                              Target = "IDtarget",
                              Value = "value", 
                              NodeID = "name", 
                              # LinkGroup	 character string specifying the groups in the Links. Used to color the links in the network.
                              sinksRight=FALSE) ##  If TRUE, the last nodes are moved to the right border of the plot.
# you save it as an html
networkD3::saveNetwork(p, "graph/decision.html")

# you convert it as png -- Need first webshot::install_phantomjs()
webshot::webshot(paste0(getwd(),"/graph/decision.html"),paste0(getwd(),"/graph/decision.png"), vwidth = 800, vheight = 500)
#getwd()
#![ ](graph/decision.png)

```

:::{.page-break}
:::

# PART II: Analysis of Situation 

## Impact of Covid-19, a dramatic restriction of solutions 

Since the first case of COVID-19 was recorded in December 2019, more than 170 million people worldwide have contracted the virus. The Americas is among the most affected regions  

Durable solutions include voluntary repatriation, resettlement to a third country, local integration, naturalization and return to place of origin prior to displacement (for IDPs). However, a growing number of displaced populations have limited opportunities for a durable solution. The COVID-19 pandemic has only exacerbated these challenges.

![Costa Rica. UNHCR expands cash assistance programme during COVID-19 crisis](media/image_cbi.jpg)

The partial or full closure of borders, along with more general restrictions on movement aimed at limiting the pandemic's spread, has dramatically impacted opportunities for displaced people to return to their home countries or resettle to other countries.
 
```{r message=FALSE, warning=FALSE, fig.height=5, fig.cap = "**| Trends for Solution**"}
multiple_line_df <- solutions_long.asy %>%
  filter(UNHCRBureau  == thisbureau &
           !(is.na(UNHCRBureau))) %>%
  group_by(Year, Solution.type ) %>%
  summarise(Value2 = sum(Value) ) 

#Make plot
ggplot(multiple_line_df, aes(x = Year, y = Value2, 
                                              colour = Solution.type)) + # Adding reference to color
  geom_line(size = 1) + # Here we mention that it will be a line chart
  # stat_smooth(size=1.5, 
  #             method = "loess", 
  #             level = 0.95, 
  #             fullrange = TRUE, 
  #             se = FALSE) + 
  # 
  
  geom_hline(yintercept = 0, size = 1.1, colour = "#333333") +
  scale_y_continuous( label = format_si()) + ## Format axis number
  
  xlim(c(2000, lastyear + 6)) +
  
  #scale_colour_viridis_d() + ## Add color for each lines based on color-blind friendly palette
  scale_colour_manual( values = c( "NAT" = "#a6cee3",
                                   "RST"  = "#1f78b4",
                                   "RET" = "#b2df8a")) +
  geom_label(aes(x = lastyear + .5 ,
                 y = as.numeric(multiple_line_df[multiple_line_df$Solution.type == "NAT" & multiple_line_df$Year == lastyear , c("Value2")]) ,
                 label = "Naturalisation"),
                             hjust = 0,
                             vjust = 0.5,
                             colour = "#a6cee3",
                             fill = "white",
                             label.size = NA,
                             family = "Lato",
                             size = 4) +
   geom_label(aes(x = lastyear +.5,
                  y = as.numeric(multiple_line_df[multiple_line_df$Solution.type == "RST" & multiple_line_df$Year == lastyear , c("Value2")] + 10000),
                  label = "Resettlement"),
                             hjust = 0,
                             vjust = 0.5,
                             colour = "#1f78b4",
                             fill = "white",
                             label.size = NA,
                             family = "Lato",
                             size = 4) +
   geom_label(aes(x = lastyear + .5,
                  y = as.numeric(multiple_line_df[multiple_line_df$Solution.type == "RET" & multiple_line_df$Year == lastyear , c("Value2")] - 10000),
                   label = "Return"),
                             hjust = 0,
                             vjust = 0.5,
                             colour = "#b2df8a",
                             fill = "white",
                             label.size = NA,
                             family = "Lato",
                             size = 4) +
  
  unhcRstyle::unhcr_theme(base_size = 8)  + ## Insert UNHCR Style
  theme(legend.position = "none",
        panel.grid.major.y  = element_line(color = "#cbcbcb"), 
        panel.grid.major.x  = element_blank(), 
        panel.grid.minor = element_blank()) + ### changing grid line that should appear
  ## and the chart labels
  labs(title = "Solution for Displacement in the Americas ",
       subtitle = "Evolution in the past 20 years",
       x = "",
       y = "",
       caption = "Source: UNHCR.org/refugee-statistics ")
```

Resettlement solution dramatically decreased in the region.

```{r message=FALSE, warning=FALSE, comment = "", fig.height=4, size="small", fig.cap = "**| Ressettlement Trends in the last 25 years in the America**"}
#Prepare data
multiple_line_df <- solutions_long.asy %>%
  filter(solutions_long.asy$UNHCRBureau == thisbureau  &
           Year > (lastyear - 30) & 
          Solution.type.label == "Resettlement arrivals" ) %>%
  group_by(Year, Solution.type.label ) %>%
  summarise(Value2 = sum(Value) )  %>%
  mutate(Year = as.integer(Year) ) 

#Make plot
ggplot(multiple_line_df, aes(x = Year, y = Value2 #, 
                                              #colour = Population.type
                             )) + 
  geom_bar(stat = "identity", 
           position = "identity", 
           fill = "#0072bc" ) + # here we configure that it will be bar chart
  
  scale_y_continuous( label = format_si()) + ## Format axis number
  xlim(c(lastyear-30, lastyear+1)) +
  #facet_wrap( vars(Solution.type.label ), ncol = 2) +

  geom_hline(yintercept = 0, size = 1.1, colour = "#333333") +
  unhcRstyle::unhcr_theme(base_size = 8)  + ## Insert UNHCR Style
  theme(panel.grid.major.y  = element_line(color = "#cbcbcb"), 
        panel.grid.major.x  = element_blank(), 
        panel.grid.minor = element_blank()) + ### changing grid line that should appear
  ## and the chart labels
  labs(title = "Resettlement Opportunities have reached its lowest level ever ",
       subtitle = "Trends in the past 30 years for the Americas Region ",
       x = "",
       y = "",
       caption = "Source: UNHCR.org/refugee-statistics ")

``` 


:::{.page-break}
:::
## Venezuela Situation

As the second-largest displacement crisis in the world, refugees and migrants from Venezuela now total 5.7 million globally, of which more than 80 percent are hosted by countries in Latin America and the Caribbean. 

```{r message=FALSE, warning=FALSE, comment = "", fig.height=5, size="small", fig.cap = "**| Proportion of the population who are refugees, by country of origin (SDG Indicator 10.7.4)**"}
end_year_population_totals_long.ori %>%
  filter(Population.type  %in% c("REF","ASY","VDA") & 
           Year == lastyear &
           UNHCRBureau  == thisbureau &
           !(is.na(UNHCRBureau))) %>%
  group_by(CountryOriginName, CountryOriginCode) %>%
  summarise(Value2 = sum(Value) )  %>%
  #mutate( value3 =  format_si(Value2)) %>%
  arrange(desc(Value2)) %>%
  head(10) %>% 
  mutate(CountryOriginName = str_replace(CountryOriginName, " \\(Bolivarian Republic of\\)", "")) %>%
  
    ## Now merge with WB Data 
  left_join(wb_data %>% select("SP.POP.TOTL","CountryAsylumCode", "Year") %>% filter(Year == lastyear), by = c(  CountryOriginCode = "CountryAsylumCode"    )) %>%  
  mutate(ref.part = round(Value2/(SP.POP.TOTL+Value2),4)  ) %>% 
  ggplot(aes( x= ref.part, fct_reorder(CountryOriginName, ref.part))) +
  geom_col(fill = "#0072BC") +
  geom_label(aes(label = scales::percent(ref.part, accuracy = .01)),
             color = "black", hjust = "inward") +
  scale_x_continuous(labels = scales::label_percent(accuracy = .01)) +
  labs(x = NULL, 
       y = NULL,
       title = paste0("Number of refugees, asylum seekers & displaced across borders by country of origin"),
       subtitle =     "As a proportion of the national population of that country of origin",
         caption = "Total count of population who have been recognized as refugees as a proportion of the total population of their country of origin, expressed per 100,000 population.  Refugees refers to persons recognized by the Government and/or UNHCR, or those in a refugee-like
situation.  Population refers to total resident population in a given country in a given year.") +
  geom_hline(yintercept = 0, size = 1.1, colour = "#333333") +
  unhcRstyle::unhcr_theme(base_size = 8) + ## Insert UNHCR Style
  theme(panel.grid.major.x = element_line(color = "#cbcbcb"), 
        panel.grid.major.y = element_blank()) ### changing grid line that should appear
```


To date, more than 171,000 have been recognized as refugees and over 850,000 asylum claims have also been lodged worldwide. Across the region, just under 2.7 million have been granted some form of residency or regular stay permit.  

Inside Venezuela, UNHCR protects and assists refugees and Venezuelan nationals. The latter is done in the framework of the Humanitarian Response Plan which targets 4.5 million persons in need. Primarily through the protection cluster and the cluster responsible for shelter, energy and non-food items, UNHCRs coordination and operational efforts support people on-the-move, at risk of displacement, host communities, as well as limited numbers of spontaneous returns, especially in border areas and along key population movement routes.  

```{r ,message=FALSE, warning=FALSE, comment = "", fig.height=8, size="small", fig.cap = "**| Venezuelan Diaspora Abroad**"}
## Map showing the venezuelan exodus
allVene <- end_year_population_totals_long.asy %>%
  filter(  Year == lastyear &
           Population.type != "IDP"  &
           CountryOriginCode == "VEN"&
           CountryAsylumCode != "VEN") %>%
  group_by( CountryAsylumName, Latitude, Longitude) %>%
  summarise(Value2 = sum(Value) )  %>%
  mutate(Label = format(round(Value2, -3),  big.mark=","))  %>%
 # mutate(Label2 = unhcRstyle::format_si()Value2)  %>%  # unhcRstyle::format_si(100000000)
  arrange(desc(Value2)) %>%
  head(10) # %>%  
  ## Change to robinson  world projection
  #  mutate %>% 

## Getting world map for mapping
world <- 
rnaturalearth::ne_countries(scale = "small", returnclass = "sf") %>%
  filter(continent == "North America" | continent == "South America")
## Remove Antartica
world <- world[ world$sov_a3 != "ATA", ]

# plot
ggplot(data = world) + 
  geom_sf(fill = "antiquewhite", colour = "#7f7f7f", size = 0.2) + 
  #coord_sf(xlim = c(-25, 65), ylim = c(25, 75), expand = FALSE) + ## Clipping on Mediterranean Sea
  geom_point(data = allVene, aes(x = Longitude, y = Latitude , size = Value2 ), 
             alpha = 0.6, colour = "red") +
  scale_size_area( max_size = 20) +
 #   coord_sf(crs = "+proj=robin") +
  labs(title = "All Top 10 Countries hosting Venezuelans of Concern are in the Americas",
       subtitle = "As of 2020",
       x = "",
       y = "",
       caption = "Source: UNHCR.org/refugee-statistics ") + 
  
  unhcRstyle::unhcr_theme(base_size = 8)  + ## Insert UNHCR Style
  theme(#panel.grid.major = element_line(color = gray(.5),  linetype = "dashed", size = 0.5),
        panel.grid.major = element_blank(),
        panel.background = element_rect(fill = "aliceblue"),
        axis.text.x  = element_blank(),
        axis.text.y  = element_blank(),
        legend.position = "none"
        )


```

:::{.page-break}
:::

## Central America

Central America is the most violence place of Americas and of the entire world. The violence seems concentrated in the big cities and Criminal gangs have territorial control in Central America, where poverty is rampant. In these areas, people experiment poverty and economic inequality.

```{r  message=FALSE, warning=FALSE, comment = "", fig.height=5, size="small", fig.cap = "**| Conflict-related deaths per 100,000 population (SDG Indicator 16.1.2)**"}

fata <- acled.data %>% 
  # filter(year == lastyear) %>% 
  # group_by(yearctr,country ) %>% 
  # count(country, wt = fatalities) %>% 
  
  ## better to do the average over the last 3 years...
  filter(year %in% c(2018,2019,2020)) %>% 
  group_by(country, iso3)  %>% 
  count(country, wt = fatalities /3) %>% 
  mutate( yearctr  = paste0(iso3, 2020))  %>% 
  
    left_join(wb_data %>% select("SP.POP.TOTL","yearctr"), by = c(  "yearctr"    )) %>%
  ## get fatalities Percentage
  mutate(fatalities_per_100k = round(  (n/as.numeric(SP.POP.TOTL)*100000) , 1)) %>% 
  top_n(10, fatalities_per_100k) 


  ## Now the chart 
ggplot( data = fata,
  aes(fatalities_per_100k, fct_reorder(country, fatalities_per_100k))) +
 # geom_col(fill = "#0072BC") +
  geom_col( fill = ifelse(fata$iso3 %in% c("BLZ", "SLV", "HND", "MEX", "GTM"), "#e59400", "#CCCCCC")) +
  # geom_text(aes(label = scales::label_comma()(fatalities_per_100k)), 
  #           hjust = "inward", 
  #           color = "black") +
  scale_x_continuous(labels = scales::label_comma()) +
  labs(x = "Fatalities per 100,000 population", 
       y = " ", 
       title = "The five most violent countries in Americas are from the central America",
       subtitle = "Average Conflict-related deaths per 100,000 population, 2018-2020",
       caption = "Source: Acled Data - https://acleddata.com") +
  geom_hline(yintercept = 0, size = 1.1, colour = "#333333") +
  unhcRstyle::unhcr_theme(base_size = 8)   + ## Insert UNHCR Style
  theme(panel.grid.major.x = element_line(color = "#cbcbcb"), 
        panel.grid.major.y = element_blank()) ### changing grid line that should appear
```

As already discussed in the section on violence, those patterns of violence are part of the [root causes](https://www.hsdl.org/?view&did=856841) for the important migration from those region to the United States.


```{r ,message=FALSE, warning=FALSE, cache = TRUE, comment = "", fig.height=3, size="small", ig.cap = "**| People from Central America in the USA**"}

pobp_dict <- jsonlite::fromJSON("https://data.census.gov/api/search/metadata/item?id=ACSPUMS1Y2019.POBP")
pobp_dict <- pobp_dict$response$metadataContent$ACSPUMS1Y2019.POBP$values %>% as_tibble()

acs <- jsonlite::fromJSON("https://api.census.gov/data/2019/acs/acs1/pums?tabulate=weight(PWGTP)&col+YOEP&row+POBP")
acs <- acs[-1] %>% map_dfr(~set_names(., unlist(acs[[1]])))
acs <- acs %>% mutate(across(-POBP, as.numeric), POBP = set_names(pobp_dict$label, pobp_dict$value)[POBP])
acs <- 
  acs %>% 
  rename(coo = POBP) %>% 
  filter(coo == "Honduras" | coo == "Guatemala" | coo == "El Salvador") %>% 
  pivot_longer(-coo, names_to = "year", values_to = "pop")

acs_totals <- acs %>% count(coo, wt = pop)

popstats <- jsonlite::fromJSON("https://api.unhcr.org/population/v1/population/?limit=20&dataset=population&displayType=totals&columns%5B%5D=refugees&columns%5B%5D=asylum_seekers&year%5B%5D=2019&coo=HON%2CSAL%2CGUA&coa=USA")$items %>% as_tibble()

data <- 
  left_join(acs %>% count(coo, wt = pop),
                  popstats %>% transmute(coo = coo_name, poc = refugees + asylum_seekers)) %>% 
  mutate(p = poc/n)

data %>% 
  ggplot() +
  geom_col(aes(coo, n), fill = unhcRstyle::unhcr_grey ) +
  geom_col(aes(coo, poc), fill = unhcRstyle::unhcr_blue) +
  geom_hline(yintercept = 0, size = 1.1, colour = "#333333")  +
  geom_text(aes(coo, n, label = scales::label_comma()(n)), hjust = 1, color = "white") +
  geom_label(aes(coo, poc/2, label = scales::label_percent()(p))) +
  scale_y_continuous(labels = scales::label_comma()) +
  labs(x = NULL, y = "# of individuals",
       title = "Proportion of People of Concerns to UNHCR ",
       subtitle = "Highlighting the situation of nationals from Northen Central Americas in the USA",
       caption = "Data sources: Overlay of US Census Bureau - American Community Survey 2019 & UNHCR Refugee Data Finder") +
  #theme_minimal() + 
  coord_flip() +
  unhcRstyle::unhcr_theme(base_size = 8)  +
  theme(axis.text = element_text(size = 6),
        legend.position = "none",
        panel.grid.major.x = element_line(color = "#cbcbcb"), 
        panel.grid.major.y = element_blank()) ### changing grid line that should appear) 
```
To respond to this specific situation, UNHCR has developed a massive [scale-up plan of its operation](https://reporting.unhcr.org/node/21855)

:::{.page-break}
:::

# PART III: Challenges on Refugee and IDP Statistics

![ ](media/image_hand.jpg)

In this last chapter, we discuss 3 mains statistical challenges specific to the region.

## Using Survey to get demographic profiles


Often demographic data are not available in Americas. Available demographic data for persons of concern in the region for __`r lastyear`__ show a balance between sex. Of the total population, more than 30 per cent are children below the age of 18 and around the 5 per cent are elderly 60 years and above. More than 35 per cent are between 18-59 years.

```{r message=FALSE, warning=FALSE, fig.cap = "**| How far Demographic breakdown is available?**"}
## percentage of the total population within the country for which demographic breakdown is available

```

```{r message=FALSE, warning=FALSE, comment = "", fig.height=4, size="small", fig.cap = "**| Demographic breakdown**"}
demographics <- merge(x = demographics, by.x="CountryOriginCode", y = reference, by.y= "iso_3", all.x = TRUE)
#names(demographics)
pyramid <-  demographics[ demographics$Year == max(demographics$Year),
                          c("REGION_UN",
                          "Female04",
                              "Female511",
                              "Female1217",
                              "Female1859",
                              "Female60ormore",
                              "FemaleUnknown",
                             # "FemaleTotal",
                              "Male04",
                              "Male511",
                              "Male1217",
                              "Male1859",
                              "Male60ormore",
                              "MaleUnknown"#,
                             # "MaleTotal"       
                             )]  


pyramid2 <- data.frame(lapply(pyramid, function(x) { as.numeric( gsub("NA", "0", x)) })) %>%
  pivot_longer(
    cols = Female04:MaleUnknown,
    names_to = "Class",
    #names_to = c("Class","REGION_UN" ),
    #names_sep = "_",
     #names_repair = "unique",
    #names_prefix = "",
    values_to = "Sum",
    values_drop_na = TRUE
  ) 

pyramid3 <- as.data.frame(aggregate(pyramid2$Sum,
                                          by = list(pyramid2$Class#, pyramid2$REGION_UN
                                                    ),
                                          sum))
names(pyramid3)[1] <- "Class"
names(pyramid3)[2] <- "Count"

library(stringr)
pyramid3 <- pyramid3 %>% 
  mutate(gender = case_when(str_detect(Class, "Male") ~ "Male",
                            str_detect(Class, "Female") ~ "Female")) %>% 
  mutate(age = case_when(str_detect(Class, "04") ~ "0-4",
                         str_detect(Class, "511") ~ "5-11",
                         str_detect(Class, "1217") ~ "12-17",
                         str_detect(Class, "1859") ~ "18-59",
                         str_detect(Class, "60") ~ "60+",
                         str_detect(Class, "Unknown") ~ "Unknown")) 

pyramid3$pc <- pyramid3$Count / sum(pyramid3$Count) * 100
pyramid3$age <- factor(pyramid3$age, levels = c("0-4", "5-11",  "12-17",  "18-59", "60+", "Unknown"))

## Add images for geneder
#men <- magick::image_read(paste0(  substring(getwd(), 0 , nchar(getwd()) - 4) ,"inst/men.png"))
#women <- magick::image_read(paste0(  substring(getwd(), 0 , nchar(getwd()) - 4) ,"inst/women.png"))

icon <- data.frame(
   c("men", "women"),
   c(paste0(  substring(getwd(), 0 , nchar(getwd()) - 4) ,"inst/men.png"),
                     paste0(  substring(getwd(), 0 , nchar(getwd()) - 4) ,"inst/women.png")),
   c("0-4","0-4"),
   c( 15, -15)
)
names(icon)[1] <- "icon"
names(icon)[2] <- "path"
names(icon)[3] <- "age"
names(icon)[4] <- "pc"

# Or add to plot as annotation
# men <- magick::image_fill(men, 'none')
# men <- as.raster(men) 
# women <- magick::image_fill(women, 'none')
# women <- as.raster(women) 

#annotation_raster(men, 25, 35, 3, 5) + 
#annotation_raster(women, 25, 35, 3, 5) + 

ggplot(pyramid3, aes(x = age, 
                     fill = gender,
                      y = ifelse(test = gender == "Female",
                            yes = -pc, no = pc)) ) + 
  geom_bar(stat = "identity") +
  scale_y_continuous(labels = abs, limits = max(pyramid3$pc) * c(-1,1)) +
  labs(title = "Population Pyramid (proportion of age group)  ",
       subtitle = paste0("For all displaced population as of ", max(demographics$Year)),
       x = "", 
       y = "Percent of population",
       caption =  "Source: UNHCR Population Statistics") +
#  scale_colour_manual(values = c("pink", "steelblue"),
  scale_colour_manual(values = c("#126db4","#01ab91"), # based on Asia Report
                      aesthetics = c("colour", "fill")) +
  coord_flip()+
  #ggimage::geom_image(data = icon, aes(image = path, x =age, y = pc)) +
  #annotation_raster(women, 15, 20, "0-4", "5-11") +
  #annotation_raster(men, -15, -20, "0-4", "5-11") + 
  unhcRstyle::unhcr_theme(base_size = 8) 

# ggplot(data = icon, aes(x = age,  
#                       y =  pc)) + 
#  ggimage::geom_image(, aes(image = pathc)) 

```




## Other of Concerns in El Salvador, Honduras, Guatemala & Mexico

In Honduras, El Salvador, Guatemala and Mexico, The situation is characterized by a complex mixed movement, including flows of thousands of persons transiting towards the north, with a significant - though difficult to quantify - number of persons with possible protection needs. Currently, "_Mixed movements_" and "_people in transit_" have been categorized in the Other persons of concern (OoC) category. The following summarizes the OoC figures (2018-2020) for El Salvador and Honduras, Guatemala and Mexico.  

```{r message=FALSE, warning=FALSE, comment = "", fig.height=4, size="small", fig.cap = "**| OOC in Central America**"}

ooc_central <-   end_year_population_totals_long.asy[end_year_population_totals_long.asy$CountryAsylumCode %in% c("GTM", "SLV", "HND", "MEX") &
                                                              end_year_population_totals_long.asy$Population.type =="OOC" ,
                                                            c("CountryAsylumCode","CountryAsylumName", "Year", "Value") ]  %>%
  group_by(Year, CountryAsylumCode, CountryAsylumName ) %>%
  summarise(Value = sum(Value) ) 

ggplot(ooc_central, 
       aes(x=Year, 
           y=Value, 
           color=CountryAsylumName, 
           linetype=CountryAsylumName)) +
  stat_smooth(size=1.5, 
              method = "loess", 
              level = 0.95, 
              fullrange = TRUE, 
              se = FALSE) + 
  # scale_color_manual(values=c(IDMC="orange",
  #                             UNHCR="sienna" )) + 
  
  scale_y_continuous( label = format_si()) + ## Format axis number
  geom_hline(yintercept = 0, size = 1.1, colour = "#333333") +
  unhcRstyle::unhcr_theme(base_size = 8)  + ## Insert UNHCR Style
  theme(#legend.position = "none"
        panel.grid.major.y  = element_line(color = "#cbcbcb"), 
        panel.grid.major.x  = element_blank(), 
        panel.grid.minor = element_blank()    ) +
  ## and the chart labels
  labs(title = "Other of Concerns in Central America ",
       subtitle = "..",
       x = "",
       y = "",
       caption = "Source: UNHCR.org/refugee-statistics & IDMC ") 

```
 

Guatemala and Mexico operations have similar method: The figure of OoC correspond to an estimation of flows of deportees/persons in transit with possible protection needs during the year, estimated based on border data and the proportion of persons in transit with possible protection needs based on protection monitoring exercises conducted by partners and UNHCR. In El Salvador and Honduras as well, the figure corresponds to Salvadorian deported population with possible protection needs. The group is estimated as the proportion of deported persons during the year that reported insecurity/violence as reason for leaving the country, based on interviews conducted by the government upon return of the populations and information comes from IOM based on data from DGME (Government), but the estimation is made by UNHCR. 

The main limitations of the method used to measure  Other persons of concern category for Honduras, El Salvador, Guatemala and Mexico are related to (i) different sources of data and duplication (ii) harmonization of methods used to estimate these flows across countries; (iii) awareness / validation from Governments in the region around these figures; (iv) how to properly distinguish flows vs. stocks in UNHCR reporting both for statistical and programmatic (persons assisted) purposes.  

The scarcity and low quality of data in this context can justify the use of best available source as soon as this is correctly documented. According to the draft UNHCR Statistical Quality Assurance Framework: UNHCR publishes statistics  including definitions of concepts, target populations, indicators and other terminology describing the output and its limitations for easier interpretation by users.

Reflecting mixed movements into official UNHCR figures comes some challenges:  

  1. __Statistical vs Operational categories__: Currently there is no unified standard for recording mixed movements, so they have been lumped in the Other persons of concern (OoC). It might not be the best option for visibility and understanding of the complexity of different mixed movements.    
  
  2. __Reporting challenge__: In the current system, it is not possible to report the number of assisted individuals for a population category unless that same category is first recorded as a stock.   
  
  3. __Political Sensitiveness__: Problem with deportees or persons in transit with Protection needs that reflects on a population that was potentially not able to access protection support and/or asylum.   
  
  4. __Technical Challenge__: Because of the methods used to estimate those population categories, there are inherent risk of duplication of records between the different type of flows and across countries. 

Following the ?????? [10 points plan of actions on mixed movements](https://www.unhcr.org/the-10-point-plan-in-action.html), UNHCR needs to improve its capacity to report mixed movements. The Other persons of concern statistical category might need to be broken down into operational sub-categories to facilitate the understanding of the complexity of different mixed movements and enable better programmatic response. To set up a system that would allow to both address operational demand and statistical consistency, it could be both needed to develop and validate specific operational reporting categories for mixed movement  and to articulate the reporting of those categories between [UNHCR operational portal for Central America](https://data.unhcr.org/es/situations/cam) and UNHCR Official Statistical Reporting. 


  
  NICARAGUA

In the ASR 2020 reported 72,458 Nicaraguans, the 1 per cent of population (According to the 2019 revision of the World Population Prospects, Nicaragua has a population of 6,465,501). According with UNHCR data: 8711 Refugees, 62082 RSD and 1665 Other of concern. Nevertheless, for categorization issues others 37,801 Nicaraguans are reported in ASR in other categories for a total of 110,259 Nicaraguans (1.7 per cent of the total population of Nicaragua). For instance, in RSD of Costa Rica there are 39,500 unknown country of origin, more than half of them are Nicaraguan cases of persons who have started their asylum process by making an initial phone appointment but have not yet been able to formalize their applications.

  
  
## IDP Population Estimation in Colombia

Colombia IDP are the Internally Displaced Persons (IDP) is the 17 per cent of world's IDP (8,253,000 over 48,557,439). This is the official figure. This is a historical and cumulative figure of IDPs is being used nowadays. 

The evolution in the last 20 years shows a significant increased in Internally Displaced Persons, especially in Colombia (8,252,788 over `r totalIDP` in the region). 

```{r message=FALSE, warning=FALSE, cache= TRUE}
## Chart comparing UNHCR & IDMC figures 

ckanr::ckanr_setup("https://data.humdata.org")

ckanr::package_search("name:idmc-idp-data-for-colombia", as = "table") %>% 
  purrr::pluck("results", "resources", 1, "url") %>% 
  purrr::walk(~ckanr::ckan_fetch(., store = "disk", path = fs::path(here::here("data-raw"), fs::path_file(.))))

read_sans_hxl <- function(file, ...) {
  hdrs <- readr::read_csv(file, n_max = 0) %>% names()
  
  readr::read_csv(file, col_names = hdrs, skip = 2, ...)
}

displacement_data_colombia <- read_sans_hxl(here::here("data-raw/displacement_data_colombia.csv"))
names(displacement_data_colombia)[4] <- "IDMC"
```


```{r  message=FALSE, warning=FALSE, comment = "", fig.height=4, size="small", fig.cap = "**| IDP Population estimates in Colombia**"}

#names(unhcr_idp_Colombia)
unhcr_idp_Colombia <-   end_year_population_totals_long.asy[end_year_population_totals_long.asy$CountryOriginCode == "COL" &
                                                              end_year_population_totals_long.asy$Population.type =="IDP" ,
                                                            c("CountryOriginCode", "Year", "Value") ]  %>%
  dplyr::left_join( displacement_data_colombia ,  by = c("Year")) %>%
  mutate( #IDMC = 'Conflict Stock Displacement',
          UNHCR = Value)  %>%
  select(Year, IDMC , UNHCR)


unhcr_idp_Colombia2 <-  reshape2::melt(unhcr_idp_Colombia,
                                       # ID variables - all the variables to keep but not split apart on
                  id.vars=c("Year" ),
                  # The source columns
                  measure.vars=c("IDMC","UNHCR"),
                  # Name of the destination column that will identify the original
                  # column that the measurement came from
                  variable.name="Source",
                  value.name="Value")

ggplot(unhcr_idp_Colombia2, 
       aes(x=Year, 
           y=Value, 
           color=Source, 
           linetype=Source)) +
  stat_smooth(size=1.5, 
              method = "loess", 
              level = 0.95, 
              fullrange = TRUE, 
              se = FALSE) + 
  scale_color_manual(values=c(IDMC="orange",
                              UNHCR="sienna" )) + 
  
  scale_y_continuous( label = format_si()) + ## Format axis number
  geom_hline(yintercept = 0, size = 1.1, colour = "#333333") +
  unhcRstyle::unhcr_theme(base_size = 8)  + ## Insert UNHCR Style
  theme(#legend.position = "none"
        panel.grid.major.y  = element_line(color = "#cbcbcb"), 
        panel.grid.major.x  = element_blank(), 
        panel.grid.minor = element_blank()    ) +
  ## and the chart labels
  labs(title = "IDP Population Estimate in Colombia ",
       subtitle = "Comparison between Data Sources",
       x = "",
       y = "",
       caption = "Source: UNHCR.org/refugee-statistics & IDMC ") 

```
 

Total number of IDPs as of 31 December 2020 as per [IDMC](https://www.internal-displacement.org/countries/colombia): 4,922,000 
 

This figure refers to people internally displaced since 1985 by the armed conflict in Colombia.  Pending further information and evidence, those who are in a situation of displacement, but progressing towards a durable solution have not been included. Though IDMC includes some information on [potential caveheat](https://www.internal-displacement.org/sites/default/files/2021-05/figure-analysis-col_0.pdf)
 
:::{.bg-blue}
This figure was obtained from the RUV, which is maintained by the Colombian governments UARIV. It is based on the total number of people displaced in Colombia according to the RUV. From this total number, IDMC subtracts registered IDPs who are deceased as well as those who have made progress towards a durable solution. Estimates of the latter are based on RUVs vulnerability assessment, which evaluates IDPs vulnerabilities associated with housing, family reunification, access to identification documents, nutrition, health, education and income.  

???We have high confidence in this figure as Colombias RUV is the most comprehensive register of IDPs in the world. However, Colombian law holds that displaced people can declare themselves as such for up to two years after they become displaced. Combined with the administrative processes for reviewing cases, this can lead to a time lag between the start date of displacement and the time of its registration in the Colombian governments database. For this reason, this figure is likely to be a slight underestimate and it may not represent the full extent of displacement in the country. This said, it provides the most representative and accurate picture of internal displacement to date in Colombia. 
:::

A revision of the IDPs in Colombia can change this figure using [EGRIS IRIS](https://www.unhcr.org/statistics/unhcrstats/600188974/international-recommendations-internally-displaced-persons-statistics-iris.html) - the Composite indicator measurement on HH Survey could be an opportunity.  


                       
# CONCLUSION: the Importance of EGRIS International Recommandations

As for any statistics, it is important to understand the limitation behind the numbers. 11 UNHCR country offices and 3 multi-country offices (Washington, Panama & Buenos Aires) are in charge of gathering the population data of UNHCR about 44 countries of Americas. Although the 'Statistics focal point' within each operation is often an 'Information Management Office', there are situations where it can be either a 'Protection' or 'Registration' officer. 

It is only in a minority of situation that Statistical data within the country are sources through  National Statistics Office (NSO), as often information on Refugees and RSD figures are directly provided by Refugees Authority within the local administration. Indeed, discussions have been established with National Statistics Offices in less than half of the operations. In half of the country, once data have been transformed and consolidated in the format used for its needs,  UNHCR needs to obtain the approval of the government to disseminate the final figures.

It is of strategic important to strengthen or build relations between UNHCR and National Statistics Offices for the following reasons: 

 * NSOs are indeed a key component of the Sustainable Development Goal Framework and remains the authority in charge of providing the data.

 * NSO's are the main stakeholder to mobilize in order to include Refugees and Forcibly Displaced Persons within their National Household Survey programmes.
 
 * Many population estimations request advanced procedures and techniques that can hardly be implemented without the expertise available within NSO
 
The  [Expert Group on Refugee and IDP Statistics (EGRIS)](https://ec.europa.eu/eurostat/web/expert-group-on-refugee-statistics),  in  which  UNHCR  belongs  to  the  steering committee, has released the [International Recommendations on Refugee Statistics (IRRS)](https://ec.europa.eu/eurostat/web/products-manuals-and-guidelines/-/KS-GQ-18-004) , which were adopted by the United Nations Statistical Commission during its 2018 session and is a strong Last updated: February 2021 reference for refugee statistics reporting methodologies. UNHCR supports National Statistical Offices (NSO) to build capacity to report on forced displacement in countries that currently lack disaggregated data on refugees. United Nations Statistical Commission is high level statistical authority in world.

                       
:::{.bg-blue}                       
The official statistics is the only way to secure quality and durable statics on refugee data.The EGRIS book International Recommendations on Refugee Statistics (IRRS) describes the role of official statistics on refugee data, please see chapter 6.

In the world many low and middle-income countries draw their data on refugees from records maintained by UNHCR. In Americas the refugees data are manly produced by the governments. 
There are different sources and multiple approaches available for the collection of refugee data such as
administrative registers, population censuses, surveys or combinations of these. Each data collection method has its own strengths and limitations

In Americas Ministries, departments or agencies (e.g. CONARE), are usually the competent authorities for maintaining administrative registers of refugees and asylum seekers. Often, their legal basis and rationale do not include statistical requirements. In these cases, efforts to collaborate and gain cooperation between NSOs and relevant agencies can become problematic. The restrictive laws of ministries that may take precedence over statistics laws, can reduce the power of National Statistics Offices (NSOs) and interrupt the production of statistics. National statistical systems are usually, but not always, directed and coordinated by a NSO

A well-functioning system for production of statistics requires a stable and transparent legal basis which can guarantee the independence, integrity and accountability of statistical authorities according to the Fundamental Principles of Official Statistics

However, refugee statistics can be very politically sensitive. Dissemination is the time when the statistical product is released to users. It represents one of the most important activities of the national statistical system. Dissemination should be viewed as the link between data availability and the use of statistics for policymaking purposes.

National Statistics Offices (NSOs), empowered by law, can enter into data sharing arrangements with data producing agencies to collect, compile and harmonize data, or to collaborate and share data. These may include informal or formal agreements such as: working groups; Memoranda of Understanding (MOU); consultative committees; interagency committees; and a system of focal points between NSOs and data producers. Such partnerships require mutual understanding of priorities, sharing of expertise, consistency in the integration, interpretation and use of data, and continuous communication about data stewardship, with a feedback loop between the agencies concerned when problems arise so that the issues can be resolved between the agencies concerned.

Sharing data with NSOs may be perceived as risky by immigration authorities, as data may be
misrepresented in statistical publications. To mitigate the risk of data interpretation issues, it is important to implement oversight structures around the use of the data. 

National statistical systems produce the official data according with the international statistical system. National statistical  systems vary from country to country, depending on the national administrative and governance structures, the evolution of the countrys statistical system, and the state of development of and resources available for official statistics. 

More broadly, national statistical systems are guided by a number of international and regional standards,
some of which are mandatory and some advisory. These are intended to coordinate the production of
statistics internationally, to improve the comparability of statistics between countries, and to maintain
quality standards.


Challenges to harmonizing refugee statistics

The development of comparable refugee statistics across time and space is an important issue for planning
and policymaking, public debate, the international community, as well as both countries of origin and
host countries. The production of international refugee statistics calls for the adoption of harmonized and
standardized definitions, variables and concepts. The nature of this process is complex and faces various
difficulties and limitations, which include:
a) Limitations concerning determination of population size owing to use of different data sources and
different definitions.
b) Limitations concerning international comparability and the need to harmonize.


To improve access to refugee statistics at the national level:

i) Include refugee publications and statistical databases on national statistics websites.
ii) Provide training to the media and users in the concepts and definitions relating to refugee and
asylum statistics.
iii) Improve access to data by making anonymised databases accessible to users, where possible
supporting open microdata in secure data enclaves.
:::
                       
                       
                       

:::{.bg-blue}
On the 7th and 8th of June 2021, UNHCR together with CENTROESTAD-SICA convened a [virtual workshop](https://www.unhcr.org/blogs/egris-international-recommendations-dissemination-in-central-americas/), held in Spanish, to raise awareness on the international recommendations and discuss their implementation in the among statistics office of the Central American Integration System (SICA). Among the take away from the workshop, it appears that there is space to introduce questions in the next census and survey of NSOs: Four National Statistics Offices have committed to introduce questions on internal displacement in their forthcoming census or household surveys.
:::





:::{.page-break}
:::

# ANNEXES: Glossary of UNHCR Statistical Concept

Forcibly Displaced Population data are sent to UNHCR Country Offices by member states, usually through national institutions responsible for data production in the area of refugee and asylum (National Statistical Offices, Ministry of Interior, Ministry of Justice, and Administrative Tribunals). D. When a country does not report refugee figures to UNHCR, estimations based on positive decisions on asylum applications from previous years are used. 

UNHCR [Population Statistics Database](https://www.unhcr.org/refugee-statistics/)  contains data about UNHCR's populations of concern from the year 1951 up to 2014 as well as their general composition by location of residence or origin, their status, their evolution over time. This includes different population type and solution events:
 

 *  __Refugees__ include individuals recognized under the 1951 Convention relating to the Status of Refugees; its 1967 Protocol; the 1969 OAU Convention Governing the Specific Aspects of Refugee Problems in Africa; those recognised in accordance with the UNHCR Statute; individuals granted complementary forms of protection; or those enjoying temporary protection. Since 2007, the refugee population also includes people in a refugee-like situation. __Refugees__ recognized by the Government and/or UNHCR include:   

      *  (a) persons recognized as refugees by Governments having ratified the 1951 United Nations Convention Relating to the Status of Refugees, and/or its 1967 Protocol; 
      *  (b) persons recognized as refugees under the 1969 Organization of African Unity (OAU) Convention Governing the Specific Aspects of Refugee Problems in Africa;  
      *  (c) those recognized in accordance with the principles enshrined in the Cartagena Declaration;  
      *  (d) persons recognized by UNHCR as refugees in accordance with its Statute (otherwise referred to as mandate refugees);  
      *  (e) those who have been granted a complementary form of protection (i.e. non-Convention);  
      *  (f) persons who have been granted temporary protection on a group basis;  Persons in a refugee-like situation refer to those outside their territory of origin who face protection risks similar to those of refugees, but who, for practical or other reasons, have not been formally recognized or issued documentation to that effect. 


 *  __Asylum-seekers__ are individuals who have sought international protection and whose claims for refugee status have not yet been determined, irrespective of when they may have been lodged.

 *  __Internally displaced persons (IDPs)__ are people or groups of individuals who have been forced to leave their homes or places of habitual residence, in particular as a result of, or in order to avoid the effects of armed conflict, situations of generalised violence, violations of human rights, or natural or man-made disasters, and who have not crossed an international border. For the purposes of UNHCR's statistics, this population only includes conflict-generated IDPs to whom the Office extends protection and/or assistance. Since 2007, the IDP population also includes people in an IDP-like situation. For global IDP estimates, see [www.internal-displacement.org](http://www.internal-displacement.org).

 *  __Returned refugees__ are former refugees who have returned to their country of origin spontaneously or in an organised fashion but are yet to be fully integrated. Such return would normally only take place in conditions of safety and dignity.

 *  __Returned IDPs__ refer to those IDPs who were beneficiaries of UNHCR's protection and assistance activities and who returned to their areas of origin or habitual residence during the year.

 *  __Stateless persons__ are defined under international law as persons who are not considered as nationals by any State under the operation of its law. In other words, they do not possess the nationality of any State. UNHCR statistics refer to persons who fall under the agencys statelessness mandate because they are stateless according to this international definition, but data from some countries may also include persons with undetermined nationality.  

 *  __Others of concern__ refers to individuals who do not necessarily fall directly into any of the groups above, but to whom UNHCR extends its protection and/or assistance services, based on humanitarian or other special grounds (e.g. based on regional documents, peace agreements, General Assembly resolutions). Persons with whom UNHCR is engaged purely on a good offices basis, such as, for instance, rejected asylum-seekers, are not included. This group also includes __Host Community__, i.e, communities that hosts large populations of refugees or internally displaced persons, whether in camps, integrated into households, or independently.

 *  __Venezuelan Displaced Abroad__: People of Venezuelan origin displaced across borders, and  who are likely to be in need of international protection under the criteria contained in the Cartagena Declaration, but who have not applied for asylum in the country in which they are present. Regardless of status, Venezuelans displaced abroad require protection against forced returns, and access to basic services. UNHCR and the International Organization for Migration work together with this population by leading the Regional Inter-Agency Coordination Platform, which is aimed at strengthening the protection dimensions and consistent responses across the region in line with human rights standards.
 
 
Every year, UNHCR publish its Population Statistics Reference. it includes detailed statistics from each country on __Refugee Status Determination__. The data set contains not only reference by country of asylum and country of origin but also: 

 * Type of procedure: RSD conducted by UNHCR (U), the Government (G), or Jointly (J) by UNHCR and the Government.  
 * Applications refer to "new" applications (N), "re-opened/repeat" applications (R) and/or "appeal" applications (A).  
 * Applications refer to number of persons (P) or number of cases (C). (Preference: PERSONS)  
 * Decisions refer to first instance (FI), appeal/administrative review (AR), judicial review (JR), New applications (NA), Repeat/reopened  applications (RA), US Citizenship and Immigration Services (IN), US Executive Office of Immigration Review (EO), Subsidiary protection (SP), First instance and appeal (FA) and/or Temporary asylum (TA).
 
 

:::{.page-break}
:::




